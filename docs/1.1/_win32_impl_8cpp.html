<html>
 <head>
  <link rel="stylesheet" href="maven-theme.css"> 
  <title>AppSecInc. MSI Extensions</title>
 </head>
 <body>


<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>src/CustomActions/SystemTools/Win32Impl.cpp File Reference</h1><code>#include &quot;<a class="el" href="_custom_actions_2_system_tools_2_std_afx_8h-source.html">StdAfx.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="_win32_impl_8h-source.html">Win32Impl.h</a>&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Namespaces</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_win32___copy_files.html">Win32_CopyFiles</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_win32___move_files.html">Win32_MoveFiles</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_win32___delete_files.html">Win32_DeleteFiles</a></td></tr>

<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_win32___copy_files.html#dc4448efb699ac4c8d84db0ce4c4c99c">Win32_CopyFiles::CopyFilesAttributes</a> { <a class="el" href="namespace_win32___copy_files.html#dc4448efb699ac4c8d84db0ce4c4c99c57e76e13d3bb8dad172436f4cb4e7b3e">Win32_CopyFiles::CopyOnInstall</a> =  1, 
<a class="el" href="namespace_win32___copy_files.html#dc4448efb699ac4c8d84db0ce4c4c99ce11d080779f1c99fa65be92fb01ec7b0">Win32_CopyFiles::CopyOnUnInstall</a> =  2, 
<a class="el" href="namespace_win32___copy_files.html#dc4448efb699ac4c8d84db0ce4c4c99c9ab6165c88a75e699edddb10c1652365">Win32_CopyFiles::CopyRecurse</a> =  16
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_win32___move_files.html#92e00d3fb27eaacf5124fd4e426db703">Win32_MoveFiles::MoveFilesAttributes</a> { <a class="el" href="namespace_win32___move_files.html#92e00d3fb27eaacf5124fd4e426db703776721ed3ebf8c7278573d92c7799128">Win32_MoveFiles::MoveOnInstall</a> =  1, 
<a class="el" href="namespace_win32___move_files.html#92e00d3fb27eaacf5124fd4e426db703df5960905655e95bc56b7aee3c54f8a0">Win32_MoveFiles::MoveOnUnInstall</a> =  2, 
<a class="el" href="namespace_win32___move_files.html#92e00d3fb27eaacf5124fd4e426db703f7c363dc122fec8c3ba183abfba3d479">Win32_MoveFiles::MoveRecurse</a> =  16, 
<a class="el" href="namespace_win32___move_files.html#92e00d3fb27eaacf5124fd4e426db7035465e981d398f9d32c5b1776c549a81b">Win32_MoveFiles::DeleteEmptyDirectories</a> =  32
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_win32___delete_files.html#e5d900d75b3b4dad6c0cda00f7444b9a">Win32_DeleteFiles::DeleteFilesAttributes</a> { <br>
&nbsp;&nbsp;<a class="el" href="namespace_win32___delete_files.html#e5d900d75b3b4dad6c0cda00f7444b9a56c16f0276b56ea9cdbb1d35ca3c3516">Win32_DeleteFiles::DeleteOnInstall</a> =  1, 
<a class="el" href="namespace_win32___delete_files.html#e5d900d75b3b4dad6c0cda00f7444b9afa50720f643329e555612bec9a8a598e">Win32_DeleteFiles::DeleteOnUnInstall</a> =  2, 
<a class="el" href="namespace_win32___delete_files.html#e5d900d75b3b4dad6c0cda00f7444b9a266dc8b409a105962791bc0acda2e204">Win32_DeleteFiles::CheckIfExists</a> =  16, 
<a class="el" href="namespace_win32___delete_files.html#e5d900d75b3b4dad6c0cda00f7444b9abbcd0d7c31bbc11e4f79843588872524">Win32_DeleteFiles::DeleteRecurse</a> =  32, 
<br>
&nbsp;&nbsp;<a class="el" href="namespace_win32___delete_files.html#e5d900d75b3b4dad6c0cda00f7444b9a90fcdf23483ae92ad13fd1c64c974a45">Win32_DeleteFiles::DeleteEmptyDirectories</a> =  64
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07">ExecuteAttributes</a> { <br>
&nbsp;&nbsp;<a class="el" href="_template_files_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07812b5ef2fba293dd6164259f2bcb323c">ExecuteOnInstall</a> =  1, 
<a class="el" href="_template_files_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07a3a746a55f3c573cae8b575b3f5a5044">ExecuteOnUnInstall</a> =  2, 
<a class="el" href="_win32_impl_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a0756c1b99327adced1f0acf3820c495943">ContinueOnError</a> =  1, 
<a class="el" href="_win32_impl_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07812b5ef2fba293dd6164259f2bcb323c">ExecuteOnInstall</a> =  2, 
<br>
&nbsp;&nbsp;<a class="el" href="_win32_impl_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07a3a746a55f3c573cae8b575b3f5a5044">ExecuteOnUnInstall</a> =  4, 
<a class="el" href="_win32_impl_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a0799a3c75a8573a209c7a043ae1a32053e">ScheduleIndependently</a> =  32
<br>
 }</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#7445a024ec90b7b90e7eb732a0280c3a">Win32_CopyFile</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy a file.  <a href="#7445a024ec90b7b90e7eb732a0280c3a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#728eb15b8f81fd20219bddf836d5cf16">Win32_MoveFile</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Move a file.  <a href="#728eb15b8f81fd20219bddf836d5cf16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#35b67b2ff3f0a754493a9dd57293c60f">Win32_DeleteFile</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delete a file.  <a href="#35b67b2ff3f0a754493a9dd57293c60f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#22b8b1b3de0ef5723744ae19a1b37996">Win32_DeleteDirectory</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delete a directory with all subdirectories and files.  <a href="#22b8b1b3de0ef5723744ae19a1b37996"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#39ed888090187e32c404017909c91b0d">Win32_CreateDirectory</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a directory.  <a href="#39ed888090187e32c404017909c91b0d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#5561721da80b4f69019dbd9b3d173dd2">Win32_CopyFiles_Deferred</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#ad52c963af698b03ea788b45b08b8c45">Win32_CopyFiles_Immediate</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy files. This is a table-driven custom action. Use in combination with <a class="el" href="class_app_sec_inc_1_1_wix_1_1_extensions_1_1_system_tools_extension.html">AppSecInc::Wix::Extensions::SystemToolsExtension</a>.  <a href="#ad52c963af698b03ea788b45b08b8c45"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#f7ac05e032662f45bafe463867cfa8ba">Win32_MoveFiles_Deferred</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#a21d18c9fce32ca4ae72aad3c2a78747">Win32_MoveFiles_Immediate</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Move files. This is a table-driven custom action. Use in combination with <a class="el" href="class_app_sec_inc_1_1_wix_1_1_extensions_1_1_system_tools_extension.html">AppSecInc::Wix::Extensions::SystemToolsExtension</a>.  <a href="#a21d18c9fce32ca4ae72aad3c2a78747"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#5e7c7f28c0c5902c2c3dc7b212d9777b">Win32_DeleteFiles_Deferred</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#b13f30444521047c49e8ecb3dac8e1be">Win32_DeleteFiles_Immediate</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delete files. This is a table-driven custom action. Use in combination with <a class="el" href="class_app_sec_inc_1_1_wix_1_1_extensions_1_1_system_tools_extension.html">AppSecInc::Wix::Extensions::SystemToolsExtension</a>.  <a href="#b13f30444521047c49e8ecb3dac8e1be"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#332abc91b6940a5bc063b26d5390f5ab">Win32_Execute_Immediate</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute commands (immediate). This is a table-driven custom action. Use in combination with <a class="el" href="class_app_sec_inc_1_1_wix_1_1_extensions_1_1_system_tools_extension.html">AppSecInc::Wix::Extensions::SystemToolsExtension</a>.  <a href="#332abc91b6940a5bc063b26d5390f5ab"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#63573e1c6c575995751234694935a600">Win32_Execute_Rollback</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute commands (rollback). This is a table-driven custom action. Use in combination with <a class="el" href="class_app_sec_inc_1_1_wix_1_1_extensions_1_1_system_tools_extension.html">AppSecInc::Wix::Extensions::SystemToolsExtension</a>.  <a href="#63573e1c6c575995751234694935a600"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#ed7655ebfe2a3f578270cc572d93b2e8">Win32_Execute_Deferred</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute commands (deferred). This is a table-driven custom action. Use in combination with <a class="el" href="class_app_sec_inc_1_1_wix_1_1_extensions_1_1_system_tools_extension.html">AppSecInc::Wix::Extensions::SystemToolsExtension</a>.  <a href="#ed7655ebfe2a3f578270cc572d93b2e8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#3d39699b73da42b71278aa0744a2597e">Win32_GetFileSize</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the size of a file.  <a href="#3d39699b73da42b71278aa0744a2597e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#5853230d600dea21d00e5e8a077ee0e2">Win32_FileExists</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if file exists.  <a href="#5853230d600dea21d00e5e8a077ee0e2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_win32_impl_8cpp.html#31b1ef5f3440f5ebf29f115c2b4726c0">Win32_GetParentDirectory</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the parent directory.  <a href="#31b1ef5f3440f5ebf29f115c2b4726c0"></a><br></td></tr>
</table>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="c80d223a1e32cfc6e6fdf1987c948a07"></a><!-- doxytag: member="Win32Impl.cpp::ExecuteAttributes" ref="c80d223a1e32cfc6e6fdf1987c948a07" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="_template_files_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07">ExecuteAttributes</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="c80d223a1e32cfc6e6fdf1987c948a07812b5ef2fba293dd6164259f2bcb323c"></a><!-- doxytag: member="ExecuteOnInstall" ref="c80d223a1e32cfc6e6fdf1987c948a07812b5ef2fba293dd6164259f2bcb323c" args="" -->ExecuteOnInstall</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="c80d223a1e32cfc6e6fdf1987c948a07a3a746a55f3c573cae8b575b3f5a5044"></a><!-- doxytag: member="ExecuteOnUnInstall" ref="c80d223a1e32cfc6e6fdf1987c948a07a3a746a55f3c573cae8b575b3f5a5044" args="" -->ExecuteOnUnInstall</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="c80d223a1e32cfc6e6fdf1987c948a0756c1b99327adced1f0acf3820c495943"></a><!-- doxytag: member="ContinueOnError" ref="c80d223a1e32cfc6e6fdf1987c948a0756c1b99327adced1f0acf3820c495943" args="" -->ContinueOnError</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="c80d223a1e32cfc6e6fdf1987c948a07812b5ef2fba293dd6164259f2bcb323c"></a><!-- doxytag: member="ExecuteOnInstall" ref="c80d223a1e32cfc6e6fdf1987c948a07812b5ef2fba293dd6164259f2bcb323c" args="" -->ExecuteOnInstall</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="c80d223a1e32cfc6e6fdf1987c948a07a3a746a55f3c573cae8b575b3f5a5044"></a><!-- doxytag: member="ExecuteOnUnInstall" ref="c80d223a1e32cfc6e6fdf1987c948a07a3a746a55f3c573cae8b575b3f5a5044" args="" -->ExecuteOnUnInstall</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="c80d223a1e32cfc6e6fdf1987c948a0799a3c75a8573a209c7a043ae1a32053e"></a><!-- doxytag: member="ScheduleIndependently" ref="c80d223a1e32cfc6e6fdf1987c948a0799a3c75a8573a209c7a043ae1a32053e" args="" -->ScheduleIndependently</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="7445a024ec90b7b90e7eb732a0280c3a"></a><!-- doxytag: member="Win32Impl.cpp::Win32_CopyFile" ref="7445a024ec90b7b90e7eb732a0280c3a" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_CopyFile           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Copy a file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>WIN32_SOURCE_FILENAME</em>&nbsp;</td><td>Fully qualified path to the file to copy. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>WIN32_TARGET_FILENAME</em>&nbsp;</td><td>Fully qualified path to the target file. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>WIN32_TARGET_OVERWRITE</em>&nbsp;</td><td>One of "yes", "no", "error".</td></tr>
  </table>
</dl>
Unlike wix built-in custom actions the files copied with Win32_CopyFile are not tracked by MSI. Use Win32_CopyFile to copy a configuration file that will be preserved on uninstall for example. 
</div>
</div><p>
<a class="anchor" name="5561721da80b4f69019dbd9b3d173dd2"></a><!-- doxytag: member="Win32Impl.cpp::Win32_CopyFiles_Deferred" ref="5561721da80b4f69019dbd9b3d173dd2" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_CopyFiles_Deferred           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="ad52c963af698b03ea788b45b08b8c45"></a><!-- doxytag: member="Win32Impl.cpp::Win32_CopyFiles_Immediate" ref="ad52c963af698b03ea788b45b08b8c45" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_CopyFiles_Immediate           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Copy files. This is a table-driven custom action. Use in combination with <a class="el" href="class_app_sec_inc_1_1_wix_1_1_extensions_1_1_system_tools_extension.html">AppSecInc::Wix::Extensions::SystemToolsExtension</a>. 
<p>

</div>
</div><p>
<a class="anchor" name="39ed888090187e32c404017909c91b0d"></a><!-- doxytag: member="Win32Impl.cpp::Win32_CreateDirectory" ref="39ed888090187e32c404017909c91b0d" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_CreateDirectory           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a directory. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>WIN32_PATH</em>&nbsp;</td><td>Fully qualified path to the directory to create; may contain several levels of directories to make. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>WIN32_PATH_CREATED Full qualified path that has been created first; this is the top level directory that didn't exist. </dd></dl>

</div>
</div><p>
<a class="anchor" name="22b8b1b3de0ef5723744ae19a1b37996"></a><!-- doxytag: member="Win32Impl.cpp::Win32_DeleteDirectory" ref="22b8b1b3de0ef5723744ae19a1b37996" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_DeleteDirectory           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Delete a directory with all subdirectories and files. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>WIN32_PATH</em>&nbsp;</td><td>Fully qualified path to the directory to delete. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="35b67b2ff3f0a754493a9dd57293c60f"></a><!-- doxytag: member="Win32Impl.cpp::Win32_DeleteFile" ref="35b67b2ff3f0a754493a9dd57293c60f" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_DeleteFile           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Delete a file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>WIN32_FILENAME</em>&nbsp;</td><td>Fully qualified path to the file to delete.</td></tr>
  </table>
</dl>
Unlike <a class="el" href="namespace_wix.html">Wix</a> FileCopy the files deleted by Win32_DeleteFile are not tracked by MSI. Do not delete a file that belongs to a component. 
</div>
</div><p>
<a class="anchor" name="5e7c7f28c0c5902c2c3dc7b212d9777b"></a><!-- doxytag: member="Win32Impl.cpp::Win32_DeleteFiles_Deferred" ref="5e7c7f28c0c5902c2c3dc7b212d9777b" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_DeleteFiles_Deferred           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="b13f30444521047c49e8ecb3dac8e1be"></a><!-- doxytag: member="Win32Impl.cpp::Win32_DeleteFiles_Immediate" ref="b13f30444521047c49e8ecb3dac8e1be" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_DeleteFiles_Immediate           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Delete files. This is a table-driven custom action. Use in combination with <a class="el" href="class_app_sec_inc_1_1_wix_1_1_extensions_1_1_system_tools_extension.html">AppSecInc::Wix::Extensions::SystemToolsExtension</a>. 
<p>

</div>
</div><p>
<a class="anchor" name="ed7655ebfe2a3f578270cc572d93b2e8"></a><!-- doxytag: member="Win32Impl.cpp::Win32_Execute_Deferred" ref="ed7655ebfe2a3f578270cc572d93b2e8" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_Execute_Deferred           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Execute commands (deferred). This is a table-driven custom action. Use in combination with <a class="el" href="class_app_sec_inc_1_1_wix_1_1_extensions_1_1_system_tools_extension.html">AppSecInc::Wix::Extensions::SystemToolsExtension</a>. 
<p>

</div>
</div><p>
<a class="anchor" name="332abc91b6940a5bc063b26d5390f5ab"></a><!-- doxytag: member="Win32Impl.cpp::Win32_Execute_Immediate" ref="332abc91b6940a5bc063b26d5390f5ab" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_Execute_Immediate           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Execute commands (immediate). This is a table-driven custom action. Use in combination with <a class="el" href="class_app_sec_inc_1_1_wix_1_1_extensions_1_1_system_tools_extension.html">AppSecInc::Wix::Extensions::SystemToolsExtension</a>. 
<p>

</div>
</div><p>
<a class="anchor" name="63573e1c6c575995751234694935a600"></a><!-- doxytag: member="Win32Impl.cpp::Win32_Execute_Rollback" ref="63573e1c6c575995751234694935a600" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_Execute_Rollback           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Execute commands (rollback). This is a table-driven custom action. Use in combination with <a class="el" href="class_app_sec_inc_1_1_wix_1_1_extensions_1_1_system_tools_extension.html">AppSecInc::Wix::Extensions::SystemToolsExtension</a>. 
<p>

</div>
</div><p>
<a class="anchor" name="5853230d600dea21d00e5e8a077ee0e2"></a><!-- doxytag: member="Win32Impl.cpp::Win32_FileExists" ref="5853230d600dea21d00e5e8a077ee0e2" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_FileExists           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check if file exists. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>WIN32_FILENAME</em>&nbsp;</td><td>Fully qualified path to the file to check </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>WIN32_FILE_EXISTS "1" if file exists; "0" otherwise.</dd></dl>
<dl class="user" compact><dt><b>Example:</b></dt><dd><div class="fragment"><pre class="fragment">&lt;CustomAction Id=<span class="stringliteral">"Win32_FileExists_SetFilename"</span> Property=<span class="stringliteral">"WIN32_FILENAME"</span> Value=<span class="stringliteral">"[SystemFolder]\shell32.dll"</span> /&gt;
&lt;CustomAction Id=<span class="stringliteral">"Win32_FileExists"</span> DllEntry=<span class="stringliteral">"Win32_FileSize"</span> BinaryKey=<span class="stringliteral">"SystemTools"</span> /&gt;
&lt;CustomAction Id=<span class="stringliteral">"GetSizeIfExists"</span> DllEntry=<span class="stringliteral">"Win32_FileSize"</span> BinaryKey=<span class="stringliteral">"SystemTools"</span> /&gt;
&lt;InstallExecuteSequence&gt;
  &lt;Custom Action=<span class="stringliteral">"Win32_FileExists_SetFilename"</span> After=<span class="stringliteral">"AppSearch"</span>&gt;1&lt;/Custom&gt;
  &lt;Custom Action=<span class="stringliteral">"Win32_FileExists"</span> After=<span class="stringliteral">"Win32_GetFileSize_SetFilename"</span>&gt;1&lt;/Custom&gt;
  &lt;Custom Action=<span class="stringliteral">"GetSizeIfExists"</span> After=<span class="stringliteral">"Win32_FileExists"</span> &gt;WIN32_FILE_EXISTS = <span class="stringliteral">"1"</span>&lt;/Custom&gt;
&lt;/InstallExecuteSequence&gt;
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="3d39699b73da42b71278aa0744a2597e"></a><!-- doxytag: member="Win32Impl.cpp::Win32_GetFileSize" ref="3d39699b73da42b71278aa0744a2597e" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_GetFileSize           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the size of a file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>WIN32_FILENAME</em>&nbsp;</td><td>Fully qualified path to the file to get the size of. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>WIN32_FILESIZE_FORMAT</em>&nbsp;</td><td>File size format, "AUTO" (default) for automatic, "BYTES", "KB", "MB" or "GB". </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>WIN32_FILESIZE_PRECISION</em>&nbsp;</td><td>Number of decimal digits in the result, default is 0. Results are rounded to the number of decimal digits specified. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>WIN32_FILESIZE String representing the size of the file, numbers only, without type (eg. 1.23) <p>
WIN32_FILESIZE_FORMATTED String representing the size of the file, numbers and type only (eg. 1.23 GB). <p>
WIN32_FILESIZE_BYTES String representing the size of the file in bytes, numbers only (eg. 12300000000).</dd></dl>
<dl class="user" compact><dt><b>Example:</b></dt><dd><div class="fragment"><pre class="fragment">&lt;CustomAction Id=<span class="stringliteral">"Win32_GetFileSize_SetFilename"</span> Property=<span class="stringliteral">"WIN32_FILENAME"</span> Value=<span class="stringliteral">"[SystemFolder]\shell32.dll"</span> /&gt;
&lt;CustomAction Id=<span class="stringliteral">"Win32_GetFileSize_SetFormat"</span> Property=<span class="stringliteral">"WIN32_FILESIZE_FORMAT"</span> Value=<span class="stringliteral">"MB"</span> /&gt;
&lt;CustomAction Id=<span class="stringliteral">"Win32_GetFileSize_SetPrecision"</span> Property=<span class="stringliteral">"WIN32_FILESIZE_PRECISION"</span> Value=<span class="stringliteral">"2"</span> /&gt;
&lt;CustomAction Id=<span class="stringliteral">"Win32_FileSize"</span> Property=<span class="stringliteral">"SHELL32FILE_SIZE"</span> Value=<span class="stringliteral">"[WIN32_FILESIZE_FORMATTED]"</span> /&gt;
&lt;InstallExecuteSequence&gt;
  &lt;Custom Action=<span class="stringliteral">"Win32_GetFileSize_SetFilename"</span> After=<span class="stringliteral">"AppSearch"</span>&gt;1&lt;/Custom&gt;
  &lt;Custom Action=<span class="stringliteral">"Win32_GetFileSize_SetFormat"</span> After=<span class="stringliteral">"Win32_GetFileSize_SetFilename"</span>&gt;1&lt;/Custom&gt;
  &lt;Custom Action=<span class="stringliteral">"Win32_GetFileSize_SetPrecision"</span> After=<span class="stringliteral">"Win32_GetFileSize_SetFormat"</span>&gt;1&lt;/Custom&gt;
  &lt;Custom Action=<span class="stringliteral">"Win32_GetFileSize"</span> After=<span class="stringliteral">"Win32_GetFileSize_SetPrecision"</span>&gt;1&lt;/Custom&gt;
  &lt;Custom Action=<span class="stringliteral">"Win32_FileSize"</span> After=<span class="stringliteral">"Win32_GetFileSize"</span> /&gt;
&lt;/InstallExecuteSequence&gt;
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="31b1ef5f3440f5ebf29f115c2b4726c0"></a><!-- doxytag: member="Win32Impl.cpp::Win32_GetParentDirectory" ref="31b1ef5f3440f5ebf29f115c2b4726c0" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_GetParentDirectory           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the parent directory. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>WIN32_DIRECTORY</em>&nbsp;</td><td>Fully qualified path to a directory </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>WIN32_PARENT_DIRECTORY Fully qualified path to the parent directory terminated with a backslash</dd></dl>
The value returned is either blank or always terminated with a backslash. If the directory doesn't have a parent (eg. C:\), the same directory is returned. If the directory is blank, a blank value is returned. 
</div>
</div><p>
<a class="anchor" name="728eb15b8f81fd20219bddf836d5cf16"></a><!-- doxytag: member="Win32Impl.cpp::Win32_MoveFile" ref="728eb15b8f81fd20219bddf836d5cf16" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_MoveFile           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Move a file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>WIN32_SOURCE_FILENAME</em>&nbsp;</td><td>Fully qualified path to the file to move. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>WIN32_TARGET_FILENAME</em>&nbsp;</td><td>Fully qualified path to the target file. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>WIN32_TARGET_OVERWRITE</em>&nbsp;</td><td>One of "yes", "no", "error".</td></tr>
  </table>
</dl>
Unlike wix built-in custom actions the files being moved with Win32_MoveFile are not tracked by MSI. Do not use Win32_MoveFile to copy a file that belongs to a component. 
</div>
</div><p>
<a class="anchor" name="f7ac05e032662f45bafe463867cfa8ba"></a><!-- doxytag: member="Win32Impl.cpp::Win32_MoveFiles_Deferred" ref="f7ac05e032662f45bafe463867cfa8ba" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_MoveFiles_Deferred           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="a21d18c9fce32ca4ae72aad3c2a78747"></a><!-- doxytag: member="Win32Impl.cpp::Win32_MoveFiles_Immediate" ref="a21d18c9fce32ca4ae72aad3c2a78747" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Win32_MoveFiles_Immediate           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Move files. This is a table-driven custom action. Use in combination with <a class="el" href="class_app_sec_inc_1_1_wix_1_1_extensions_1_1_system_tools_extension.html">AppSecInc::Wix::Extensions::SystemToolsExtension</a>. 
<p>

</div>
</div><p>
</div>
  <br><hr noshade>
  <table width="100%">
   <tr>
    <td valign="top" align="left">
     <font size="1">&copy; Application Security Inc. - All Rights Reserved</font>
    </td>
    <td valign="top" align="right">
     <a href="http://msiext.codeplex.com" target="_blank">http://msiext.codeplex.com</a>
    </td>
   </tr>
  </table>
 </body>
 <head>
  <link href="tabs.css" rel="stylesheet" type="text/css">
 </head>
</html>
