<html>
 <head>
  <link rel="stylesheet" href="maven-theme.css"> 
  <title>AppSecInc. MSI Extensions</title>
 </head>
 <body>


<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>src/Common/ODBC/MSSQLDatabase.h</h1><a href="_m_s_s_q_l_database_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#pragma once</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span>
<a name="l00003"></a>00003 <span class="keyword">namespace </span>AppSecInc
<a name="l00004"></a>00004 {
<a name="l00005"></a>00005         <span class="keyword">namespace </span>Databases
<a name="l00006"></a>00006         {
<a name="l00007"></a>00007                 <span class="keyword">namespace </span>MSSQL
<a name="l00008"></a>00008                 {
<a name="l00010"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html">00010</a>             <span class="keyword">class </span><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html" title="A Microsoft SQL Server database.">MSSQLDatabase</a> : <span class="keyword">public</span> AppSecInc::Databases::ODBC::ODBCDatabase
<a name="l00011"></a>00011                         {
<a name="l00012"></a>00012             <span class="keyword">private</span>:
<a name="l00013"></a>00013                 std::list&lt;MSSQLDatabaseFileSpec&gt; _filespecs;
<a name="l00014"></a>00014                 std::list&lt;std::wstring&gt; _database_options;
<a name="l00015"></a>00015                 std::wstring _database_collate;
<a name="l00016"></a>00016                 std::wstring _database_purpose;
<a name="l00017"></a>00017                 <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_connection.html" title="An ODBC connection.">AppSecInc::Databases::ODBC::ODBCConnection</a> _connection;
<a name="l00018"></a>00018                 std::wstring _connection_string;
<a name="l00019"></a>00019                 std::wstring _database_name;
<a name="l00020"></a>00020                 <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html" title="A Microsoft SQL Server database.">MSSQLDatabase</a>&amp; operator=(<span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html" title="A Microsoft SQL Server database.">MSSQLDatabase</a>&amp;);
<a name="l00021"></a>00021             <span class="keyword">public</span>:
<a name="l00023"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#230455d5134a751c78a06047ff4af356">00023</a>                 <span class="keyword">const</span> std::wstring <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#230455d5134a751c78a06047ff4af356" title="get the database name">GetName</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _database_name; }
<a name="l00025"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#0538f789d508b896160bd97255e6d839">00025</a>                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#0538f789d508b896160bd97255e6d839" title="set the database name">SetName</a>(<span class="keyword">const</span> std::wstring&amp; value) { _database_name = value; }
<a name="l00027"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#899af4dff1da694ed1d1de8ab6fe7f51">00027</a>                 <span class="keyword">const</span> std::wstring <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#899af4dff1da694ed1d1de8ab6fe7f51" title="get the database collate">GetCollate</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _database_collate; }
<a name="l00029"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#443cf7cea70b99ea143c21bad966dc51">00029</a>                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#443cf7cea70b99ea143c21bad966dc51" title="set the database collate">SetCollate</a>(<span class="keyword">const</span> std::wstring&amp; value) { _database_collate = value; }
<a name="l00031"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#d9c1079ba835b236e35819e6efdd4244">00031</a>                 <span class="keyword">const</span> std::wstring <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#d9c1079ba835b236e35819e6efdd4244" title="get the database purpose, eg. ATTACH or ATTACH_REBUILD_LOG">GetPurpose</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _database_purpose; }
<a name="l00033"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#2a66595c6532880a55130eee8191bbcc">00033</a>                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#2a66595c6532880a55130eee8191bbcc" title="set the database for">SetPurpose</a>(<span class="keyword">const</span> std::wstring&amp; value) { _database_purpose = value; }
<a name="l00035"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#f9cf3097ec60b5a77ce13386b6d7cb4b">00035</a>                 <span class="keyword">const</span> std::list&lt;MSSQLDatabaseFileSpec&gt;&amp; <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#f9cf3097ec60b5a77ce13386b6d7cb4b" title="get the database file specs">GetFileSpecs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _filespecs; }
<a name="l00037"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#c3964d343267408dbd1c9b6986715829">00037</a>                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#c3964d343267408dbd1c9b6986715829" title="add a database file spec">AddFileSpec</a>(<span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database_file_spec.html" title="A Microsoft SQL Server database file specification.">MSSQLDatabaseFileSpec</a>&amp; value) { _filespecs.push_back(value); }
<a name="l00039"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#08de92eaf9d0f4aa43342a50bedacc1d">00039</a>                 <span class="keyword">const</span> std::list&lt;std::wstring&gt;&amp; <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#08de92eaf9d0f4aa43342a50bedacc1d" title="get the database with options">GetOptions</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _database_options; }
<a name="l00041"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#63652ca7393a92faa943187e5d4018b6">00041</a>                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#63652ca7393a92faa943187e5d4018b6" title="add a database file spec">AddOption</a>(<span class="keyword">const</span> std::wstring&amp; value) { _database_options.push_back(value); }
<a name="l00043"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#9e628d3e52cd3aff4b4c1c7e76f5c4bb">00043</a>                 <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_connection.html" title="An ODBC connection.">AppSecInc::Databases::ODBC::ODBCConnection</a>&amp; <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#9e628d3e52cd3aff4b4c1c7e76f5c4bb" title="returns the connection object">GetConnection</a>() { <span class="keywordflow">return</span> _connection; }
<a name="l00044"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#2bcda534082b23900cc4d7662a9056f3">00044</a>                 <span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_connection.html" title="An ODBC connection.">AppSecInc::Databases::ODBC::ODBCConnection</a>&amp; <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#9e628d3e52cd3aff4b4c1c7e76f5c4bb" title="returns the connection object">GetConnection</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _connection; }
<a name="l00045"></a>00045                         <span class="keyword">public</span>:
<a name="l00047"></a>00047                 <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#150ee3a5f958ceb92496aa7dcf52b3ff" title="constructors/destructors">MSSQLDatabase</a>();
<a name="l00048"></a>00048                 <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#150ee3a5f958ceb92496aa7dcf52b3ff" title="constructors/destructors">MSSQLDatabase</a>(<span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_connection_info.html" title="A generic connection info.">AppSecInc::Databases::ODBC::ODBCConnectionInfo</a>&amp; connectioninfo);
<a name="l00049"></a>00049                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#83333ab3c8265f2bda2fcb46cb33aaab" title="create the database, fail if exists">Create</a>();
<a name="l00050"></a>00050                 <span class="keywordtype">bool</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#588854e0964c502769c123b9d006f501" title="returns true if database exists">Exists</a>();
<a name="l00051"></a>00051                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#e178977802372b4a1026996aaca331db" title="connect to the database server">Connect</a>();
<a name="l00052"></a>00052                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#b29a7903806fc8606df003291ffe1c91" title="disconnect from the database server">Disconnect</a>();
<a name="l00053"></a>00053                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#ce08b43208be9de7a992a797afaedd32" title="drop the database">Drop</a>();
<a name="l00054"></a>00054                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#607a4806e073e64d8d208464e5d90fe3" title="create the database if it doesn&amp;#39;t exist">CreateIfNotExists</a>();
<a name="l00055"></a>00055                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#119e6af99bb77b82bc26b91a5043706b" title="drop the database if it exists">DropIfExists</a>();
<a name="l00056"></a>00056                                 <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#564ec069ae664def9670e166175eb4b4">~MSSQLDatabase</a>();
<a name="l00057"></a>00057                 std::wstring <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#eb8653eacb2f81a03267e609ab0d7750">GetCreateQuery</a>() <span class="keyword">const</span>;
<a name="l00058"></a>00058                 std::wstring <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#4635a42b482c5de82533d3e6fe162e2d">GetDropQuery</a>() <span class="keyword">const</span>;
<a name="l00059"></a>00059                 std::wstring <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#63543331c912ca4a44d09bf97ccb7d08">GetExistsQuery</a>() <span class="keyword">const</span>;
<a name="l00060"></a>00060                 std::wstring <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#5f635085a58f086f47e775a8aee58362">GetNotExistsQuery</a>() <span class="keyword">const</span>;
<a name="l00062"></a>00062                 MSXML2::IXMLDOMNodePtr <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#f0d2a2c0d5f97fa3a1041da315e3b88e" title="serialize database to xml">Save</a>(<a class="code" href="class_app_sec_inc_1_1_xml_1_1_xml_document.html" title="An MSXML document.">AppSecInc::Xml::XmlDocument</a>&amp; xmldoc, MSXML2::IXMLDOMNodePtr parent) <span class="keyword">const</span>;
<a name="l00064"></a>00064                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_m_s_s_q_l_1_1_m_s_s_q_l_database.html#26320fc2509177f9b2b2102a1bf3f48b" title="deserialize database from xml">Load</a>(<a class="code" href="class_app_sec_inc_1_1_xml_1_1_xml_document.html" title="An MSXML document.">AppSecInc::Xml::XmlDocument</a>&amp; xmldoc, MSXML2::IXMLDOMNodePtr root);
<a name="l00065"></a>00065                         };
<a name="l00066"></a>00066                 }
<a name="l00067"></a>00067         }
<a name="l00068"></a>00068 }
</pre></div></div>
  <br><hr noshade>
  <table width="100%">
   <tr>
    <td valign="top" align="left">
     <font size="1">&copy; Application Security Inc. - All Rights Reserved</font>
    </td>
    <td valign="top" align="right">
     <a href="http://msiext.codeplex.com" target="_blank">http://msiext.codeplex.com</a>
    </td>
   </tr>
  </table>
 </body>
 <head>
  <link href="tabs.css" rel="stylesheet" type="text/css">
 </head>
</html>
