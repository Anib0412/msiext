<html>
 <head>
  <link rel="stylesheet" href="maven-theme.css"> 
  <title>AppSecInc. MSI Extensions</title>
 </head>
 <body>


<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>src/CustomActions/SystemTools/ServiceImpl.h File Reference</h1>
<p>
<a href="_service_impl_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_service_impl_8h.html#aafbb294638c5593ebd836081264c086">Service_RenameRegistryEntry</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Renames the registry entry of a service.  <a href="#aafbb294638c5593ebd836081264c086"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_service_impl_8h.html#2212a05f4d538d96df60aa96adafcf9c">Service_ChangeBinaryPathName</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Change the path to the service binary file of a service.  <a href="#2212a05f4d538d96df60aa96adafcf9c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_service_impl_8h.html#2377e950e69a1b211dcc101b260052d6">Service_ChangeDisplayName</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Change the display name of a service.  <a href="#2377e950e69a1b211dcc101b260052d6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_service_impl_8h.html#76b40e316d81dc0121ad768e516c046f">Service_ChangeDescription</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Change the description of a service.  <a href="#76b40e316d81dc0121ad768e516c046f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_service_impl_8h.html#cca83f3995fd410b141fc2800bd4ac33">Service_Control</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Control (start/stop/pause/continue) a service.  <a href="#cca83f3995fd410b141fc2800bd4ac33"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_service_impl_8h.html#c9310df1e2676388253c5e9650855b00">Service_Delete</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delete a service.  <a href="#c9310df1e2676388253c5e9650855b00"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_service_impl_8h.html#c8fad2dd15f1050f7835b35cc7b46768">Service_GetConfig</a> (MSIHANDLE hInstall)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get service configuration.  <a href="#c8fad2dd15f1050f7835b35cc7b46768"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="2212a05f4d538d96df60aa96adafcf9c"></a><!-- doxytag: member="ServiceImpl.h::Service_ChangeBinaryPathName" ref="2212a05f4d538d96df60aa96adafcf9c" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Service_ChangeBinaryPathName           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Change the path to the service binary file of a service. 
<p>
The path to the service binary file of the service specified in SERVICE_CHANGE_SERVICE_NAME is set to SERVICE_CHANGE_BINARY_PATH_NAME.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SERVICE_CHANGE_SERVICE_NAME</em>&nbsp;</td><td>name of the service </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SERVICE_CHANGE_BINARY_PATH_NAME</em>&nbsp;</td><td>new fully qualified path to the service binary file.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>check CA_ERROR on function failure </dd></dl>

</div>
</div><p>
<a class="anchor" name="76b40e316d81dc0121ad768e516c046f"></a><!-- doxytag: member="ServiceImpl.h::Service_ChangeDescription" ref="76b40e316d81dc0121ad768e516c046f" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Service_ChangeDescription           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Change the description of a service. 
<p>
Changes the description of the service specified in SERVICE_CHANGE_SERVICE_NAME. The description is changed to SERVICE_CHANGE_DESCRIPTION.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SERVICE_CHANGE_SERVICE_NAME</em>&nbsp;</td><td>name of the service </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SERVICE_CHANGE_DESCRIPTION</em>&nbsp;</td><td>new description</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>check CA_ERROR on function failure </dd></dl>

</div>
</div><p>
<a class="anchor" name="2377e950e69a1b211dcc101b260052d6"></a><!-- doxytag: member="ServiceImpl.h::Service_ChangeDisplayName" ref="2377e950e69a1b211dcc101b260052d6" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Service_ChangeDisplayName           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Change the display name of a service. 
<p>
Changes the display name of the service specified in SERVICE_CHANGE_SERVICE_NAME. The display name is changed to SERVICE_CHANGE_DISPLAY_NAME.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SERVICE_CHANGE_SERVICE_NAME</em>&nbsp;</td><td>name of the service </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SERVICE_CHANGE_DISPLAY_NAME</em>&nbsp;</td><td>new display name</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>check CA_ERROR on function failure </dd></dl>

</div>
</div><p>
<a class="anchor" name="cca83f3995fd410b141fc2800bd4ac33"></a><!-- doxytag: member="ServiceImpl.h::Service_Control" ref="cca83f3995fd410b141fc2800bd4ac33" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Service_Control           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Control (start/stop/pause/continue) a service. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SERVICE_NAME</em>&nbsp;</td><td>service name </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SERVICE_CONTROL</em>&nbsp;</td><td>action, one of SERVICE_CONTROL_START, SERVICE_CONTROL_STOP, SERVICE_CONTROL_PAUSE, SERVICE_CONTROL_CONTINUE </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="c9310df1e2676388253c5e9650855b00"></a><!-- doxytag: member="ServiceImpl.h::Service_Delete" ref="c9310df1e2676388253c5e9650855b00" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Service_Delete           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Delete a service. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SERVICE_NAME</em>&nbsp;</td><td>service name </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="c8fad2dd15f1050f7835b35cc7b46768"></a><!-- doxytag: member="ServiceImpl.h::Service_GetConfig" ref="c8fad2dd15f1050f7835b35cc7b46768" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Service_GetConfig           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get service configuration. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SERVICE_NAME</em>&nbsp;</td><td>service name </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>SERVICE_BINARY_PATH_NAME fully qualified path to the service binary file <p>
SERVICE_ERROR_CONTROL severity of the error and action taken, one of SERVICE_ERROR_IGNORE, SERVICE_ERROR_NORMAL, SERVICE_ERROR_SEVERE or SERVICE_ERROR_CRITICAL <p>
SERVICE_LOAD_ORDER_GROUP the load ordering group to which this service belongs <p>
SERVICE_DISPLAY_NAME the display name to be used by service control programs to identify the service <p>
SERVICE_START_NAME name of the account that the service process will be logged on as when it runs or the driver object name which the I/O system uses to load the device driver <p>
SERVICE_TYPE type of service, one of SERVICE_FILE_SYSTEM_DRIVER, SERVICE_KERNEL_DRIVER, SERVICE_WIN32_OWN_PROCESS, SERVICE_WIN32_SHARE_PROCESS or SERVICE_INTERACTIVE_PROCESS <p>
SERVICE_START_TYPE service start time, one of SERVICE_AUTO_START, SERVICE_BOOT_START, SERVICE_DEMAND_START, SERVICE_DISABLED or SERVICE_SYSTEM_START <p>
SERVICE_TAG_ID unique tag value for this service in the group <p>
SERVICE_DEPENDENCIES comma-separated list of dependencies </dd></dl>

</div>
</div><p>
<a class="anchor" name="aafbb294638c5593ebd836081264c086"></a><!-- doxytag: member="ServiceImpl.h::Service_RenameRegistryEntry" ref="aafbb294638c5593ebd836081264c086" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall Service_RenameRegistryEntry           </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Renames the registry entry of a service. 
<p>
Renames HKLM to HKLM.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SERVICE_RENAME_REGISTRY_ENTRY_FROM</em>&nbsp;</td><td>current service name in the registry </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SERVICE_RENAME_REGISTRY_ENTRY_TO</em>&nbsp;</td><td>new service name in the registry</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>check CA_ERROR on function failure </dd></dl>

</div>
</div><p>
</div>
  <br><hr noshade>
  <table width="100%">
   <tr>
    <td valign="top" align="left">
     <font size="1">&copy; Application Security Inc. - All Rights Reserved</font>
    </td>
    <td valign="top" align="right">
     <a href="http://msiext.codeplex.com" target="_blank">http://msiext.codeplex.com</a>
    </td>
   </tr>
  </table>
 </body>
 <head>
  <link href="tabs.css" rel="stylesheet" type="text/css">
 </head>
</html>
