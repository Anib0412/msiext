<html>
 <head>
  <link rel="stylesheet" href="maven-theme.css"> 
  <title>AppSecInc. MSI Extensions</title>
 </head>
 <body>


<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="namespaces.html"><span>Namespace List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespace_wix.html">Wix</a>::<a class="el" href="namespace_wix_1_1_extensions.html">Extensions</a>::<a class="el" href="namespace_wix_1_1_extensions_1_1_data_source.html">DataSource</a>
  </div>
</div>
<div class="contents">
<h1>Wix::Extensions::DataSource Namespace Reference</h1>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_o_d_b_c_connection.html">ODBCConnection</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_m_s_s_q_l_database_connection.html">MSSQLDatabaseConnection</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_m_s_s_q_l_database.html">MSSQLDatabase</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_m_s_s_q_l_database_option.html">MSSQLDatabaseOption</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_m_s_s_q_l_database_file_spec.html">MSSQLDatabaseFileSpec</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_m_s_s_q_l_data_binary_file.html">MSSQLDataBinaryFile</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_m_s_s_q_l_data_file.html">MSSQLDataFile</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_m_s_s_q_l_data_file_parameter.html">MSSQLDataFileParameter</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_access_database_connection.html">AccessDatabaseConnection</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_access_database.html">AccessDatabase</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_o_d_b_c_execute.html">ODBCExecute</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_o_d_b_c_execute_file.html">ODBCExecuteFile</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_o_d_b_c_execute_binary.html">ODBCExecuteBinary</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_o_d_b_c_data_source.html">ODBCDataSource</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_m_s_s_q_l_data_source.html">MSSQLDataSource</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_wix_1_1_extensions_1_1_data_source_1_1_access_data_source.html">AccessDataSource</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Windows Installer XML <a class="el" href="namespace_wix_1_1_extensions_1_1_data_source.html">DataSource</a> Extension<p>
This extension significantly simplifies authoring of data source connection points, creating databases at install time and dropping databases during uninstall. Unlike the wix Sql extensions it is constructed on top of pure ODBC and built to support other database types in the near future.<p>
<dl class="user" compact><dt><b>Example: Executing Statements on a Generic ODBC Connection</b></dt><dd><div class="fragment"><pre class="fragment">&lt;AppSecInc:ODBCConnection Id=<span class="stringliteral">"LocalGenericConnection"</span> ConnectionString=<span class="stringliteral">"Driver={SQL Server};Server=localhost,1433;Database=master;Trusted_Connection=Yes;"</span> /&gt;
&lt;Component Id=<span class="stringliteral">"MasterDatabaseSysDatabases"</span> Guid=<span class="stringliteral">"0399235A-BFF3-41ef-993C-8FA9C0E354D6"</span> KeyPath=<span class="stringliteral">"yes"</span>&gt;
  &lt;AppSecInc:ODBCExecute Id=<span class="stringliteral">"SelectSysDatabases"</span> ConnectionId=<span class="stringliteral">"LocalGenericConnection"</span> Sql=<span class="stringliteral">"SELECT * FROM sysdatabases"</span> OutputFilename=<span class="stringliteral">"[INSTALLLOCATION]SysDatabases.xml"</span> <a class="code" href="_template_files_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07812b5ef2fba293dd6164259f2bcb323c">ExecuteOnInstall</a>=<span class="stringliteral">"yes"</span> /&gt;
&lt;/Component&gt;
</pre></div></dd></dl>
<dl class="user" compact><dt><b>Example: Creating an MSSQL Database and Executing SQL Statements</b></dt><dd><div class="fragment"><pre class="fragment">&lt;AppSecInc:MSSQLDatabaseConnection Id=<span class="stringliteral">"LocalSQLServerConnection"</span> IpAddress=<span class="stringliteral">"localhost"</span> Port=<span class="stringliteral">"1433"</span> Protocol=<span class="stringliteral">"Tcp"</span> WindowsAuthentication=<span class="stringliteral">"yes"</span> /&gt;
&lt;Binary Id=<span class="stringliteral">"CreateBinaryTable_sql"</span> SourceFile=<span class="stringliteral">"CreateBinaryTable.sql"</span> /&gt;
...
&lt;File Id=<span class="stringliteral">"CreateFileTable_sql"</span> Name=<span class="stringliteral">"CreateTable.sql"</span> Source=<span class="stringliteral">"CreateTable.sql"</span> /&gt;
...
&lt;AppSecInc:MSSQLDatabase Id=<span class="stringliteral">"MSSQLDemoDatabase"</span> Name=<span class="stringliteral">"[MSSQL_DATABASE_NAME]"</span> Connection=<span class="stringliteral">"LocalSQLServerConnection"</span> <a class="code" href="_access_8cpp.html#4e58e5737cb4d714b643b2ce2df7db05f7c293706f7077b777af356d4c8caa20">CreateOnInstall</a>=<span class="stringliteral">"yes"</span> <a class="code" href="_access_8cpp.html#4e58e5737cb4d714b643b2ce2df7db05e5170dd37e39dad30804bd13ca5a77ad">DropOnUnInstall</a>=<span class="stringliteral">"yes"</span>&gt;
 &lt;AppSecInc:MSSQLDatabaseOption Id=<span class="stringliteral">"MSSQLDemoDatabase_TrustWorthyOn"</span> Value=<span class="stringliteral">"TRUSTWORTHY ON"</span> /&gt;
 &lt;AppSecInc:MSSQLDatabaseFileSpec Id=<span class="stringliteral">"MSSQLDemoDatabase_PRIMARY"</span> Name=<span class="stringliteral">"Demo_mdf"</span> Filename=<span class="stringliteral">"[INSTALLLOCATION]Demo.mdf"</span> Size=<span class="stringliteral">"10MB"</span> Type=<span class="stringliteral">"PRIMARY"</span> /&gt;
 &lt;AppSecInc:MSSQLDatabaseFileSpec Id=<span class="stringliteral">"MSSQLDemoDatabase_LOG"</span> Name=<span class="stringliteral">"Demo_ldf"</span> Filename=<span class="stringliteral">"[INSTALLLOCATION]Demo.ldf"</span> Size=<span class="stringliteral">"12MB"</span> Type=<span class="stringliteral">"LOG ON"</span> /&gt;
 &lt;AppSecInc:ODBCExecute Id=<span class="stringliteral">"MSSQLDemoDatabase_CreateOptionalTable1"</span> Sql=<span class="stringliteral">"CREATE TABLE [\[][MSSQL_DATABASE_NAME]Optional[\]].[\[]dbo[\]].[\[]OptionalTable1[\]] ( [\[]OptionalTable1_Id[\]] [\[]int[\]] IDENTITY(1,1) NOT NULL )"</span> <a class="code" href="_template_files_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07812b5ef2fba293dd6164259f2bcb323c">ExecuteOnInstall</a>=<span class="stringliteral">"yes"</span> /&gt;
 &lt;AppSecInc:ODBCExecute Id=<span class="stringliteral">"MSSQLDemoDatabase_DropOptionalTable1"</span> Sql=<span class="stringliteral">"DROP TABLE [\[][MSSQL_DATABASE_NAME]Optional[\]].[\[]dbo[\]].[\[]OptionalTable1[\]]"</span> <a class="code" href="_template_files_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07a3a746a55f3c573cae8b575b3f5a5044">ExecuteOnUnInstall</a>=<span class="stringliteral">"yes"</span> /&gt;
 &lt;AppSecInc:ODBCExecuteBinary Id=<span class="stringliteral">"MSSQLDemoDatabase_Binary"</span> <a class="code" href="_template_files_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07812b5ef2fba293dd6164259f2bcb323c">ExecuteOnInstall</a>=<span class="stringliteral">"yes"</span> BinaryId=<span class="stringliteral">"CreateBinaryTable_sql"</span> /&gt;
 &lt;AppSecInc:ODBCExecuteFile Id=<span class="stringliteral">"[#CreateFileTable_sql]"</span> <a class="code" href="_template_files_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07812b5ef2fba293dd6164259f2bcb323c">ExecuteOnInstall</a>=<span class="stringliteral">"yes"</span> /&gt;
&lt;/AppSecInc:MSSQLDatabase&gt;
</pre></div></dd></dl>
<dl class="user" compact><dt><b>Example: Inserting BULK Data into an MSSQL Database</b></dt><dd><div class="fragment"><pre class="fragment">&lt;AppSecInc:MSSQLDatabase Id=<span class="stringliteral">"MSSQLDemoDatabase"</span> Name=<span class="stringliteral">"[MSSQL_DATABASE_NAME]"</span> ConnectionId=<span class="stringliteral">"LocalSQLServerConnection"</span> <a class="code" href="_access_8cpp.html#4e58e5737cb4d714b643b2ce2df7db05f7c293706f7077b777af356d4c8caa20">CreateOnInstall</a>=<span class="stringliteral">"yes"</span> <a class="code" href="_access_8cpp.html#4e58e5737cb4d714b643b2ce2df7db05e5170dd37e39dad30804bd13ca5a77ad">DropOnUnInstall</a>=<span class="stringliteral">"yes"</span>&gt;
 &lt;AppSecInc:MSSQLDataFile Id=<span class="stringliteral">"MSSQLDemoDatabase_BulkInsert_CSV"</span> Filename=<span class="stringliteral">"[INSTALLLOCATION]BinaryTable.csv"</span> <a class="code" href="_template_files_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07812b5ef2fba293dd6164259f2bcb323c">ExecuteOnInstall</a>=<span class="stringliteral">"yes"</span> Schema=<span class="stringliteral">"dbo"</span> Table=<span class="stringliteral">"BinaryTableEncoded"</span>&gt;
  &lt;AppSecInc:MSSQLDataFileParameter Id=<span class="stringliteral">"MSSQLDemoDatabase_BulkInsert_CSV_KEEPIDENTITY"</span> Value=<span class="stringliteral">"KEEPIDENTITY"</span> /&gt;
  &lt;AppSecInc:MSSQLDataFileParameter Id=<span class="stringliteral">"MSSQLDemoDatabase_BulkInsert_CSV_DATAFILETYPE"</span> Value=<span class="stringliteral">"DATAFILETYPE = 'char'"</span> /&gt;
  &lt;AppSecInc:MSSQLDataFileParameter Id=<span class="stringliteral">"MSSQLDemoDatabase_BulkInsert_CSV_FIELDTERMINATOR"</span> Value=<span class="stringliteral">"FIELDTERMINATOR = ','"</span> /&gt;                
 &lt;/AppSecInc:MSSQLDataFile&gt;
 &lt;AppSecInc:MSSQLDataBinaryFile Id=<span class="stringliteral">"MSSQLDemoDatabase_BulkInsert_Binary_CSV"</span> BinaryId=<span class="stringliteral">"BinaryTable_csv"</span> <a class="code" href="_template_files_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07812b5ef2fba293dd6164259f2bcb323c">ExecuteOnInstall</a>=<span class="stringliteral">"yes"</span> Schema=<span class="stringliteral">"dbo"</span> Table=<span class="stringliteral">"BinaryTableNotEncoded"</span>&gt;
  &lt;AppSecInc:MSSQLDataFileParameter Id=<span class="stringliteral">"MSSQLDemoDatabase_BulkInsert_Binary_CSV_KEEPIDENTITY"</span> Value=<span class="stringliteral">"KEEPIDENTITY"</span> /&gt;
  &lt;AppSecInc:MSSQLDataFileParameter Id=<span class="stringliteral">"MSSQLDemoDatabase_BulkInsert_Binary_CSV_DATAFILETYPE"</span> Value=<span class="stringliteral">"DATAFILETYPE = 'char'"</span> /&gt;
  &lt;AppSecInc:MSSQLDataFileParameter Id=<span class="stringliteral">"MSSQLDemoDatabase_BulkInsert_Binary_CSV_FIELDTERMINATOR"</span> Value=<span class="stringliteral">"FIELDTERMINATOR = ','"</span> /&gt;
 &lt;/AppSecInc:MSSQLDataBinaryFile&gt;
&lt;/AppSecInc:MSSQLDatabase&gt;
</pre></div></dd></dl>
<dl class="user" compact><dt><b>Example: Creating Generic, Access and MSSQL Data Sources</b></dt><dd><div class="fragment"><pre class="fragment">&lt;AppSecInc:ODBCDataSource Id=<span class="stringliteral">"MSSQLDatabaseDataSource_DemoDatabase_ODBC"</span> <a class="code" href="_access_8cpp.html#4e58e5737cb4d714b643b2ce2df7db05f7c293706f7077b777af356d4c8caa20">CreateOnInstall</a>=<span class="stringliteral">"yes"</span> <a class="code" href="namespace_win32___delete_files.html#e5d900d75b3b4dad6c0cda00f7444b9afa50720f643329e555612bec9a8a598e">DeleteOnUnInstall</a>=<span class="stringliteral">"yes"</span> Driver=<span class="stringliteral">"SQL Server"</span> 
 Name=<span class="stringliteral">"DemoODBCGenericSystemDSN"</span> Type=<span class="stringliteral">"system"</span> Value=<span class="stringliteral">"Server=localhost;Description=[MSSQL_DATABASE_NAME] DSN created by ODBCDataSource;Database=[MSSQL_DATABASE_NAME];Trusted_Connection=yes"</span> /&gt;
&lt;AppSecInc:MSSQLDataSource Id=<span class="stringliteral">"MSSQLDatabaseDataSource_DemoDatabase_MSSQL"</span> <a class="code" href="_access_8cpp.html#4e58e5737cb4d714b643b2ce2df7db05f7c293706f7077b777af356d4c8caa20">CreateOnInstall</a>=<span class="stringliteral">"yes"</span> <a class="code" href="namespace_win32___delete_files.html#e5d900d75b3b4dad6c0cda00f7444b9afa50720f643329e555612bec9a8a598e">DeleteOnUnInstall</a>=<span class="stringliteral">"yes"</span>
 Name=<span class="stringliteral">"DemoMSSQLDatabaseUserDSN"</span> Type=<span class="stringliteral">"user"</span> Address=<span class="stringliteral">"localhost"</span> Description=<span class="stringliteral">"[MSSQL_DATABASE_NAME] DSN created by MSSQLDataSource"</span> 
 Database=<span class="stringliteral">"[MSSQL_DATABASE_NAME]"</span> TrustedConnection=<span class="stringliteral">"yes"</span> Server=<span class="stringliteral">"localhost"</span> Network=<span class="stringliteral">"DBMSSOCN"</span> /&gt;
&lt;AppSecInc:AccessDataSource Id=<span class="stringliteral">"AccessDemoDatabase_DataSource"</span> <a class="code" href="_access_8cpp.html#4e58e5737cb4d714b643b2ce2df7db05f7c293706f7077b777af356d4c8caa20">CreateOnInstall</a>=<span class="stringliteral">"yes"</span> DBQ=<span class="stringliteral">"[INSTALLLOCATION]Database.mdf"</span> 
 Name=<span class="stringliteral">"DemoAccessDatabaseSystemDSN"</span> Type=<span class="stringliteral">"system"</span> Description=<span class="stringliteral">"Access Demo DSN"</span> <a class="code" href="namespace_win32___delete_files.html#e5d900d75b3b4dad6c0cda00f7444b9afa50720f643329e555612bec9a8a598e">DeleteOnUnInstall</a>=<span class="stringliteral">"yes"</span> /&gt; 
</pre></div></dd></dl>
<dl class="user" compact><dt><b>Example: Creating a Microsoft Access Database</b></dt><dd></dd></dl>
<div class="fragment"><pre class="fragment">&lt;Property Id=<span class="stringliteral">"ACCESS_DATABASE_DBQ"</span> Value=<span class="stringliteral">"[INSTALLLOCATION]AccessDemoDatabase.mdf"</span>&gt;
  &lt;!-- database name saved <span class="keywordflow">for</span> uninstall --&gt;
  &lt;RegistrySearch Id=<span class="stringliteral">"AccessDatabaseDBQSearch"</span> Root=<span class="stringliteral">"HKLM"</span> Type=<span class="stringliteral">"raw"</span> Key=<span class="stringliteral">"SOFTWARE\AppSecInc\AccessDatabaseMsi"</span> Name=<span class="stringliteral">"ACCESS_DATABASE_DBQ"</span> /&gt;
&lt;/Property&gt;
&lt;Component Id=<span class="stringliteral">"AccessDatabaseMsiComponent"</span> Guid=<span class="stringliteral">"D2CF0414-4650-4192-8A6F-41F1FB31C290"</span>&gt;
  ...
  &lt;AppSecInc:AccessDatabase Id=<span class="stringliteral">"AccessDemoDatabase"</span> DBQ=<span class="stringliteral">"[ACCESS_DATABASE_DBQ]"</span> ConnectionId=<span class="stringliteral">"AccessConnection"</span> <a class="code" href="_access_8cpp.html#4e58e5737cb4d714b643b2ce2df7db05f7c293706f7077b777af356d4c8caa20">CreateOnInstall</a>=<span class="stringliteral">"yes"</span> <a class="code" href="_access_8cpp.html#4e58e5737cb4d714b643b2ce2df7db05e5170dd37e39dad30804bd13ca5a77ad">DropOnUnInstall</a>=<span class="stringliteral">"yes"</span>&gt;
    &lt;AppSecInc:ODBCExecute Id=<span class="stringliteral">"AccessDemoDatabase_CreateTable1"</span> Sql=<span class="stringliteral">"CREATE TABLE Table1 ( Table1_Id INTEGER NOT NULL )"</span> <a class="code" href="_template_files_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07812b5ef2fba293dd6164259f2bcb323c">ExecuteOnInstall</a>=<span class="stringliteral">"yes"</span> OutputFilename=<span class="stringliteral">"[INSTALLLOCATION]CreateTable1.xml"</span> /&gt;
    &lt;AppSecInc:ODBCExecute Id=<span class="stringliteral">"AccessDemoDatabase_DropTable1"</span> Sql=<span class="stringliteral">"DROP TABLE Table1"</span> <a class="code" href="_template_files_8cpp.html#c80d223a1e32cfc6e6fdf1987c948a07a3a746a55f3c573cae8b575b3f5a5044">ExecuteOnUnInstall</a>=<span class="stringliteral">"yes"</span> /&gt;
  &lt;/AppSecInc:AccessDatabase&gt;
&lt;/Component&gt;
&lt;!-- save the database name <span class="keywordflow">for</span> uninstall --&gt;
&lt;Component Id=<span class="stringliteral">"AccessDatabaseMsiRegistry"</span> Guid=<span class="stringliteral">"9B3E538F-8C30-4c68-8C00-97B1FA14522A"</span>&gt;
  &lt;RegistryKey Id=<span class="stringliteral">"AccessDatabaseMsiRegistryKey"</span> Root=<span class="stringliteral">"HKLM"</span> Key=<span class="stringliteral">"Software\AppSecInc\AccessDatabaseMsi"</span> Action=<span class="stringliteral">"createAndRemoveOnUninstall"</span>&gt;
    &lt;RegistryValue Id=<span class="stringliteral">"AccessDatabaseMsiRegistryKey_Access_DATABASE_DBQ"</span> Name=<span class="stringliteral">"ACCESS_DATABASE_DBQ"</span> Value=<span class="stringliteral">"[ACCESS_DATABASE_DBQ]"</span> Type=<span class="stringliteral">"string"</span> /&gt;
  &lt;/RegistryKey&gt;
&lt;/Component&gt;
</pre></div> </div>
  <br><hr noshade>
  <table width="100%">
   <tr>
    <td valign="top" align="left">
     <font size="1">&copy; Application Security Inc. - All Rights Reserved</font>
    </td>
    <td valign="top" align="right">
     <a href="http://msiext.codeplex.com" target="_blank">http://msiext.codeplex.com</a>
    </td>
   </tr>
  </table>
 </body>
 <head>
  <link href="tabs.css" rel="stylesheet" type="text/css">
 </head>
</html>
