<html>
 <head>
  <link rel="stylesheet" href="maven-theme.css"> 
  <title>AppSecInc. MSI Extensions</title>
 </head>
 <body>


<!-- Generated by Doxygen 1.7.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>src/Common/ODBC/RowSet.h</h1>  </div>
</div>
<div class="contents">
<a href="_row_set_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#pragma once</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span>
<a name="l00003"></a>00003 <span class="keyword">namespace </span>AppSecInc
<a name="l00004"></a>00004 {
<a name="l00005"></a>00005         <span class="keyword">namespace </span>Databases
<a name="l00006"></a>00006         {
<a name="l00007"></a>00007                 <span class="keyword">namespace </span>ODBC
<a name="l00008"></a>00008                 {
<a name="l00010"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html">00010</a>                         <span class="keyword">class </span><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html" title="An ODBC rowset.">ODBCRowSet</a>
<a name="l00011"></a>00011                         {
<a name="l00012"></a>00012                         <span class="keyword">private</span>:
<a name="l00014"></a>00014                                 <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html" title="An ODBC handle (smart pointer), bound to a connection.">ODBCHandle</a> _stmt;
<a name="l00016"></a>00016                                 std::vector&lt;ODBCColumn *&gt; _columns;
<a name="l00018"></a>00018                                 std::map&lt;std::wstring, ODBCColumn *&gt; _columnmap;
<a name="l00020"></a>00020                                 std::vector&lt;ODBCDiagnosticsMessage&gt; _messages;
<a name="l00022"></a>00022                 <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html" title="An ODBC rowset.">ODBCRowSet</a>&amp; operator=(<span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html" title="An ODBC rowset.">ODBCRowSet</a>&amp; value) { };
<a name="l00023"></a>00023                         <span class="keyword">public</span>:
<a name="l00025"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#ac408ad024a702c3d77c9b2bd758726f7">00025</a>                                 <span class="keyword">const</span> std::vector&lt;ODBCDiagnosticsMessage&gt;&amp; <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#ac408ad024a702c3d77c9b2bd758726f7" title="get the executed statement messages">GetMessages</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _messages; }
<a name="l00027"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#a4b3b1ab41e6b64e18eb81eeaa36db8d0">00027</a>                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#a4b3b1ab41e6b64e18eb81eeaa36db8d0" title="get the number of columns">GetColumnCount</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _columns.size(); }
<a name="l00029"></a>00029                                 <span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_column.html" title="An ODBC column.">ODBCColumn</a> * <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#af9ae818a584e2d9606dac3ff18483b64" title="get a column by name">operator[]</a>(<span class="keyword">const</span> std::wstring&amp; name) <span class="keyword">const</span>;
<a name="l00031"></a>00031                 <span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_column.html" title="An ODBC column.">ODBCColumn</a> * <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#af9ae818a584e2d9606dac3ff18483b64" title="get a column by name">operator[]</a>(<span class="keywordtype">int</span> index) <span class="keyword">const</span>;
<a name="l00033"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#adc059f8127acaa4427a941b48baaf252">00033</a>                                 <span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html" title="An ODBC handle (smart pointer), bound to a connection.">ODBCHandle</a>&amp; <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#adc059f8127acaa4427a941b48baaf252" title="get the statement handle">PeekStatementHandle</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _stmt; }
<a name="l00035"></a>00035                                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#a109ccce7302c9394bedf30d0fcdd649b" title="add a named column with a defined type and initial size">AddColumn</a>(<span class="keyword">const</span> std::wstring&amp; name, <span class="keywordtype">int</span> type, <span class="keywordtype">int</span> size = <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_buffer.html#aa74e39a8f1edf1ed47b51bcf91447006" title="invalid data size">ODBCColumn::INVALID_SIZE</a>);
<a name="l00037"></a>00037                                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#a5351ebe2f2309e76d56494ce8bf64c0a" title="bind the rowset to a connection">Bind</a>(SQLHANDLE hconn);
<a name="l00039"></a>00039                                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#aeedb108b947092694fe6e30bc2cd4938" title="bind columns">BindColumns</a>();
<a name="l00042"></a>00042                                 <span class="keywordtype">bool</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#ab0e8138231fcde1a7427fc474eef5abd">Fetch</a>();
<a name="l00044"></a>00044                                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#afe9807115027652712a0a5fac3f60e04" title="execute the query">ExecuteDirect</a>(<span class="keyword">const</span> std::wstring&amp; query);
<a name="l00046"></a>00046                                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#a24e1032947ad7d22f932ab9629811eb5" title="execute the query">Prepare</a>(<span class="keyword">const</span> std::wstring&amp; query);
<a name="l00048"></a>00048                                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#a70a45ba53b46f62c58662ed79e777dc7" title="execute the query">Execute</a>();
<a name="l00050"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#aa25a9c59a97d20259cf8a8b335b4c300">00050</a>                 std::wstring <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#aa25a9c59a97d20259cf8a8b335b4c300" title="get the text representation of the errors on an ODBC connection handle">GetError</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _stmt.<a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#ac22e2fa1dc8dfa801b3bedff2544f5bc" title="get the text representation of the errors on an ODBC handle">GetError</a>(); }
<a name="l00052"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#a2fa512fb9aed7462bb8aa7d52c25e149">00052</a>                                 std::vector&lt;ODBCError&gt; <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#a2fa512fb9aed7462bb8aa7d52c25e149" title="get an array of errors on the current ODBC connection">GetErrors</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _stmt.<a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a5a53c8b95eddec8d119fc5a7c7380871" title="get an array of errors on an ODBC handle">GetErrors</a>(); }
<a name="l00054"></a>00054                                 SQLSMALLINT <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#a56fd640c86c20c227ecbc86cca4035e8" title="get the actual column count in the result set">GetNumResultCols</a>() <span class="keyword">const</span>;
<a name="l00057"></a>00057                                 SQLINTEGER <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#a3e141a88a9260fa52664473c0638b6d2">GetSQLRowCount</a>() <span class="keyword">const</span>;
<a name="l00058"></a>00058                                 <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#a09c96206e96aca729d8b9f59f22366ad">ODBCRowSet</a>();
<a name="l00059"></a>00059                                 <span class="keyword">virtual</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_row_set.html#ae3315a1a527c9823f584193d1ec66bee">~ODBCRowSet</a>();
<a name="l00060"></a>00060                         };
<a name="l00061"></a>00061                 }
<a name="l00062"></a>00062         }
<a name="l00063"></a>00063 }
</pre></div></div>
</div>
  <br><hr noshade>
  <table width="100%">
   <tr>
    <td valign="top" align="left">
     <font size="1">&copy; Application Security Inc. - All Rights Reserved</font>
    </td>
    <td valign="top" align="right">
     <a href="http://msiext.codeplex.com" target="_blank">http://msiext.codeplex.com</a>
    </td>
   </tr>
  </table>
 </body>
 <head>
  <link href="tabs.css" rel="stylesheet" type="text/css">
 </head>
</html>
