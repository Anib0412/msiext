<html>
 <head>
  <link rel="stylesheet" href="maven-theme.css"> 
  <title>AppSecInc. MSI Extensions</title>
 </head>
 <body>


<!-- Generated by Doxygen 1.7.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>src/Common/ODBC/Handle.h</h1>  </div>
</div>
<div class="contents">
<a href="_handle_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#pragma once</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span>
<a name="l00003"></a>00003 <span class="keyword">namespace </span>AppSecInc
<a name="l00004"></a>00004 {
<a name="l00005"></a>00005         <span class="keyword">namespace </span>Databases
<a name="l00006"></a>00006         {
<a name="l00007"></a>00007                 <span class="keyword">namespace </span>ODBC
<a name="l00008"></a>00008                 {
<a name="l00010"></a><a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_error.html">00010</a>                         <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00011"></a>00011                         {
<a name="l00012"></a><a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_error.html#a3009790a32862d77748449a1ca61a63a">00012</a>                                 std::wstring <a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_error.html#a3009790a32862d77748449a1ca61a63a">state</a>;
<a name="l00013"></a><a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_error.html#aa16164493493b73b821b240ad3c2f7ef">00013</a>                                 std::wstring <a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_error.html#aa16164493493b73b821b240ad3c2f7ef">message</a>;
<a name="l00014"></a><a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_error.html#a3d6ca15b795cb00d686775620c008551">00014</a>                                 <span class="keywordtype">int</span> <a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_error.html#a3d6ca15b795cb00d686775620c008551">native_error</a>;
<a name="l00015"></a>00015                         } <a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_error.html" title="An ODBC error.">ODBCError</a>;
<a name="l00016"></a>00016 
<a name="l00018"></a><a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_diagnostics_message.html">00018</a>                         <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00019"></a>00019                         {
<a name="l00021"></a><a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_diagnostics_message.html#a7e7e5125f237dc8e7e97d4670a7788cd">00021</a>                                 std::wstring <a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_diagnostics_message.html#a7e7e5125f237dc8e7e97d4670a7788cd" title="Identifies the vendor of the component in which the error or warning occurred or that received the er...">vendor</a>;
<a name="l00023"></a><a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_diagnostics_message.html#ab8f67010a86f1e9851cabb5c90f1aa37">00023</a>                                 std::wstring <a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_diagnostics_message.html#ab8f67010a86f1e9851cabb5c90f1aa37" title="Identifies the component in which the error or warning occurred or that received the error or warning...">component</a>;
<a name="l00025"></a><a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_diagnostics_message.html#a7fef810e078e2e3cbfe2f1492f0a601d">00025</a>                                 std::wstring <a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_diagnostics_message.html#a7fef810e078e2e3cbfe2f1492f0a601d" title="Identifies the data source. For file-based drivers, this is typically a file format, such as Xbase[1] For DBMS-based drivers, this is the DBMS product.">datasource</a>;
<a name="l00027"></a><a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_diagnostics_message.html#aaf5fc6790ac5e06c3d63b7b2c65cb867">00027</a>                                 std::wstring <a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_diagnostics_message.html#aaf5fc6790ac5e06c3d63b7b2c65cb867" title="Generated by the ODBC component.">text</a>;
<a name="l00028"></a>00028                         } <a class="code" href="struct_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_diagnostics_message.html" title="A diagnostics message, see http://msdn.microsoft.com/en-us/library/ms713606(VS.85).aspx.">ODBCDiagnosticsMessage</a>;
<a name="l00029"></a>00029 
<a name="l00031"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html">00031</a>                         <span class="keyword">class </span><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html" title="An ODBC handle (smart pointer), bound to a connection.">ODBCHandle</a>
<a name="l00032"></a>00032                         {
<a name="l00033"></a>00033                         <span class="keyword">protected</span>:
<a name="l00035"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af8b343d214ee84e0025ac5f58e4a377e">00035</a>                 SQLSMALLINT <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af8b343d214ee84e0025ac5f58e4a377e" title="type of handle">_type</a>;
<a name="l00037"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af55fb1bae0137b3919b51995a2d87eb6">00037</a>                 SQLHANDLE <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af55fb1bae0137b3919b51995a2d87eb6" title="ODBC handle.">_handle</a>;
<a name="l00039"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a3fe93521327ddae64263b382bed7efb2">00039</a>                 SQLHANDLE <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a3fe93521327ddae64263b382bed7efb2" title="ODBC connection handle.">_hconn</a>;
<a name="l00040"></a>00040             <span class="keyword">private</span>:
<a name="l00041"></a>00041                 <span class="keywordtype">void</span> operator=(<span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html" title="An ODBC handle (smart pointer), bound to a connection.">ODBCHandle</a>&amp;);
<a name="l00042"></a>00042                         <span class="keyword">public</span>:
<a name="l00044"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a99fa60990a224ea1d6295373f7c9f67c">00044</a>                 <span class="keyword">inline</span> SQLHANDLE <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a99fa60990a224ea1d6295373f7c9f67c" title="returns the ODBC handle">Peek</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af55fb1bae0137b3919b51995a2d87eb6" title="ODBC handle.">_handle</a>; }
<a name="l00046"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a6269f52e6fcf2c52baab7bf62fb36d8c">00046</a>                                 <span class="keyword">inline</span> SQLHANDLE <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a6269f52e6fcf2c52baab7bf62fb36d8c" title="returns the connection handle">PeekConnection</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a3fe93521327ddae64263b382bed7efb2" title="ODBC connection handle.">_hconn</a>; }
<a name="l00047"></a>00047                                 <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a95130bde6db45322aa99cc2128673ee7">ODBCHandle</a>();
<a name="l00048"></a>00048                                 <span class="keyword">virtual</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a6be84eab0503b009ccb1066d6842a333">~ODBCHandle</a>();
<a name="l00050"></a>00050                                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a48b54818afcb12d199f4c2fdce9eab7f" title="allocates a handle, fails if a handle has been previously allocated">Allocate</a>(SQLSMALLINT type, SQLHANDLE hconn);
<a name="l00052"></a>00052                 <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a589009fde3fd498b8945e9fa33d8e908" title="releases the previously allocated handle, fails if no handle has been allocated">Release</a>();
<a name="l00054"></a>00054                 <span class="keyword">static</span> std::wstring <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af22df59032df72cba3ebb008c630b310" title="get the text representation of the errors on an ODBC handle">GetError</a>(SQLHANDLE handle, <span class="keywordtype">int</span> type);
<a name="l00056"></a>00056                                 <span class="keyword">static</span> std::vector&lt;ODBCError&gt; <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a13be0d92085b7a028c575b3e0b459c50" title="get an array of errors on the current ODBC handle">GetErrors</a>(SQLHANDLE handle, <span class="keywordtype">int</span> type);
<a name="l00059"></a>00059                                 <span class="keyword">static</span> std::vector&lt;std::wstring&gt; <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a7733c9c7adc8807286f82dae32b0b8bc">GetDiagFields</a>(SQLHANDLE handle, <span class="keywordtype">int</span> type, <span class="keywordtype">int</span> diagidentifier);
<a name="l00061"></a>00061                                 <span class="keyword">static</span> std::vector&lt;ODBCDiagnosticsMessage&gt; <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#acd903046ed15eb399e97424bb75ea294" title="get an array of text messages on the current ODBC handle (cleaned up SQL_DIAG_MESSAGE_TEXT)">GetDiagMessages</a>(SQLHANDLE handle, <span class="keywordtype">int</span> type);
<a name="l00063"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af22df59032df72cba3ebb008c630b310">00063</a>                 std::wstring <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af22df59032df72cba3ebb008c630b310" title="get the text representation of the errors on an ODBC handle">GetError</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af22df59032df72cba3ebb008c630b310" title="get the text representation of the errors on an ODBC handle">GetError</a>(<a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af55fb1bae0137b3919b51995a2d87eb6" title="ODBC handle.">_handle</a>, <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af8b343d214ee84e0025ac5f58e4a377e" title="type of handle">_type</a>); }
<a name="l00065"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a13be0d92085b7a028c575b3e0b459c50">00065</a>                                 std::vector&lt;ODBCError&gt; <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a13be0d92085b7a028c575b3e0b459c50" title="get an array of errors on the current ODBC handle">GetErrors</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#a13be0d92085b7a028c575b3e0b459c50" title="get an array of errors on the current ODBC handle">GetErrors</a>(<a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af55fb1bae0137b3919b51995a2d87eb6" title="ODBC handle.">_handle</a>, <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af8b343d214ee84e0025ac5f58e4a377e" title="type of handle">_type</a>); }
<a name="l00067"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#aa841514e3dde3fe730f62689430aa915">00067</a>                                 std::vector&lt;std::wstring&gt; <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#aa841514e3dde3fe730f62689430aa915" title="get an array of messages on the current ODBC handle">GetDiagFields</a>(<span class="keywordtype">int</span> diagidentifier)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#aa841514e3dde3fe730f62689430aa915" title="get an array of messages on the current ODBC handle">GetDiagFields</a>(<a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af55fb1bae0137b3919b51995a2d87eb6" title="ODBC handle.">_handle</a>, <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af8b343d214ee84e0025ac5f58e4a377e" title="type of handle">_type</a>, diagidentifier); }
<a name="l00069"></a><a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#acd903046ed15eb399e97424bb75ea294">00069</a>                                 std::vector&lt;ODBCDiagnosticsMessage&gt; <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#acd903046ed15eb399e97424bb75ea294" title="get an array of text messages on the current ODBC handle (cleaned up SQL_DIAG_MESSAGE_TEXT)">GetDiagMessages</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#acd903046ed15eb399e97424bb75ea294" title="get an array of text messages on the current ODBC handle (cleaned up SQL_DIAG_MESSAGE_TEXT)">GetDiagMessages</a>(<a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af55fb1bae0137b3919b51995a2d87eb6" title="ODBC handle.">_handle</a>, <a class="code" href="class_app_sec_inc_1_1_databases_1_1_o_d_b_c_1_1_o_d_b_c_handle.html#af8b343d214ee84e0025ac5f58e4a377e" title="type of handle">_type</a>); }
<a name="l00070"></a>00070                         };
<a name="l00071"></a>00071                 }
<a name="l00072"></a>00072         }
<a name="l00073"></a>00073 }
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 
</pre></div></div>
</div>
  <br><hr noshade>
  <table width="100%">
   <tr>
    <td valign="top" align="left">
     <font size="1">&copy; Application Security Inc. - All Rights Reserved</font>
    </td>
    <td valign="top" align="right">
     <a href="http://msiext.codeplex.com" target="_blank">http://msiext.codeplex.com</a>
    </td>
   </tr>
  </table>
 </body>
 <head>
  <link href="tabs.css" rel="stylesheet" type="text/css">
 </head>
</html>
