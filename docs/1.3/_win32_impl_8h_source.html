<html>
 <head>
  <link rel="stylesheet" href="maven-theme.css"> 
  <title>AppSecInc. MSI Extensions</title>
 </head>
 <body>


<!-- Generated by Doxygen 1.7.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>src/CustomActions/SystemTools/Win32Impl.h</h1>  </div>
</div>
<div class="contents">
<a href="_win32_impl_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#pragma once</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span>
<a name="l00003"></a>00003 <span class="keyword">using namespace </span>AppSecInc::Msi::Flags;
<a name="l00004"></a>00004 
<a name="l00005"></a><a class="code" href="_win32_impl_8h.html#aab3e964c4817c8e0ebc4bed5ce76efba">00005</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="_win32_impl_8h.html#aab3e964c4817c8e0ebc4bed5ce76efba">e_Win32CopyFile_Overwrite</a>
<a name="l00006"></a>00006 {
<a name="l00007"></a><a class="code" href="_win32_impl_8h.html#aab3e964c4817c8e0ebc4bed5ce76efbaa84f6f9c2505e0f56e28ddc3ad379ae06">00007</a>     <a class="code" href="_win32_impl_8h.html#aab3e964c4817c8e0ebc4bed5ce76efbaa84f6f9c2505e0f56e28ddc3ad379ae06">WIN32COPYFILE_OVERWRITEYES</a> = 0,
<a name="l00008"></a><a class="code" href="_win32_impl_8h.html#aab3e964c4817c8e0ebc4bed5ce76efbaa61997917cfb67a0dda30043bbc2d4a11">00008</a>     <a class="code" href="_win32_impl_8h.html#aab3e964c4817c8e0ebc4bed5ce76efbaa61997917cfb67a0dda30043bbc2d4a11">WIN32COPYFILE_OVERWRITENO</a> = 1,
<a name="l00009"></a><a class="code" href="_win32_impl_8h.html#aab3e964c4817c8e0ebc4bed5ce76efbaaf5f436fcee729bb00a777a9377d9cfc9">00009</a>     <a class="code" href="_win32_impl_8h.html#aab3e964c4817c8e0ebc4bed5ce76efbaaf5f436fcee729bb00a777a9377d9cfc9">WIN32COPYFILE_OVERWRITEERROR</a> = 2
<a name="l00010"></a>00010 };
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="struct_app_sec_inc_1_1_msi_1_1_flags_1_1_flag_map_entry_w_o_r_d.html">FlagMapEntry</a> s_Win32CopyFile_Overwrite[] = 
<a name="l00013"></a>00013 {
<a name="l00014"></a>00014     { L<span class="stringliteral">&quot;&quot;</span>, <a class="code" href="_win32_impl_8h.html#aab3e964c4817c8e0ebc4bed5ce76efbaa84f6f9c2505e0f56e28ddc3ad379ae06">WIN32COPYFILE_OVERWRITEYES</a> },
<a name="l00015"></a>00015     { L<span class="stringliteral">&quot;yes&quot;</span>, <a class="code" href="_win32_impl_8h.html#aab3e964c4817c8e0ebc4bed5ce76efbaa84f6f9c2505e0f56e28ddc3ad379ae06">WIN32COPYFILE_OVERWRITEYES</a> },
<a name="l00016"></a>00016     { L<span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="_win32_impl_8h.html#aab3e964c4817c8e0ebc4bed5ce76efbaa61997917cfb67a0dda30043bbc2d4a11">WIN32COPYFILE_OVERWRITENO</a> },
<a name="l00017"></a>00017     { L<span class="stringliteral">&quot;error&quot;</span>, <a class="code" href="_win32_impl_8h.html#aab3e964c4817c8e0ebc4bed5ce76efbaaf5f436fcee729bb00a777a9377d9cfc9">WIN32COPYFILE_OVERWRITEERROR</a> },
<a name="l00018"></a>00018 };
<a name="l00019"></a>00019 
<a name="l00030"></a>00030 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a7445a024ec90b7b90e7eb732a0280c3a" title="Copy a file.">Win32_CopyFile</a>(MSIHANDLE hInstall);
<a name="l00031"></a>00031 
<a name="l00042"></a>00042 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a728eb15b8f81fd20219bddf836d5cf16" title="Move a file.">Win32_MoveFile</a>(MSIHANDLE hInstall);
<a name="l00043"></a>00043 
<a name="l00052"></a>00052 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a35b67b2ff3f0a754493a9dd57293c60f" title="Delete a file.">Win32_DeleteFile</a>(MSIHANDLE hInstall);
<a name="l00053"></a>00053 
<a name="l00060"></a>00060 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a39ed888090187e32c404017909c91b0d" title="Create a directory.">Win32_CreateDirectory</a>(MSIHANDLE hInstall);
<a name="l00061"></a>00061 
<a name="l00067"></a>00067 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a22b8b1b3de0ef5723744ae19a1b37996" title="Delete a directory with all subdirectories and files.">Win32_DeleteDirectory</a>(MSIHANDLE hInstall);
<a name="l00068"></a>00068 
<a name="l00074"></a>00074 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#aad52c963af698b03ea788b45b08b8c45" title="Copy files. This is a table-driven custom action. Use in combination with AppSecInc::Wix::Extensions:...">Win32_CopyFiles_Immediate</a>(MSIHANDLE hInstall);
<a name="l00075"></a>00075 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a5561721da80b4f69019dbd9b3d173dd2">Win32_CopyFiles_Deferred</a>(MSIHANDLE hInstall);
<a name="l00076"></a>00076 
<a name="l00082"></a>00082 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#aa21d18c9fce32ca4ae72aad3c2a78747" title="Move files. This is a table-driven custom action. Use in combination with AppSecInc::Wix::Extensions:...">Win32_MoveFiles_Immediate</a>(MSIHANDLE hInstall);
<a name="l00083"></a>00083 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#af7ac05e032662f45bafe463867cfa8ba">Win32_MoveFiles_Deferred</a>(MSIHANDLE hInstall);
<a name="l00084"></a>00084 
<a name="l00090"></a>00090 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#ab13f30444521047c49e8ecb3dac8e1be" title="Delete files. This is a table-driven custom action. Use in combination with AppSecInc::Wix::Extension...">Win32_DeleteFiles_Immediate</a>(MSIHANDLE hInstall);
<a name="l00091"></a>00091 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a5e7c7f28c0c5902c2c3dc7b212d9777b">Win32_DeleteFiles_Deferred</a>(MSIHANDLE hInstall);
<a name="l00092"></a>00092 
<a name="l00098"></a>00098 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a332abc91b6940a5bc063b26d5390f5ab" title="Execute commands (immediate). This is a table-driven custom action. Use in combination with AppSecInc...">Win32_Execute_Immediate</a>(MSIHANDLE hInstall);
<a name="l00099"></a>00099 
<a name="l00105"></a>00105 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#aed7655ebfe2a3f578270cc572d93b2e8" title="Execute commands (deferred). This is a table-driven custom action. Use in combination with AppSecInc:...">Win32_Execute_Deferred</a>(MSIHANDLE hInstall);
<a name="l00106"></a>00106 
<a name="l00112"></a>00112 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a63573e1c6c575995751234694935a600" title="Execute commands (rollback). This is a table-driven custom action. Use in combination with AppSecInc:...">Win32_Execute_Rollback</a>(MSIHANDLE hInstall);
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="struct_app_sec_inc_1_1_msi_1_1_flags_1_1_flag_map_entry_w_o_r_d.html">FlagMapEntry</a> s_Win32GetFileSize_Format[] = 
<a name="l00115"></a>00115 {
<a name="l00116"></a>00116     { L<span class="stringliteral">&quot;&quot;</span>, (WORD) <a class="code" href="namespace_app_sec_inc_1_1_file.html#a1b0de034680c8387ee2015f15fcb8fa6ae8bca6b3700b8453ef20b3cedbb10cef">AppSecInc::File::FILESIZE_AUTO</a> }, 
<a name="l00117"></a>00117     { L<span class="stringliteral">&quot;AUTO&quot;</span>, (WORD) <a class="code" href="namespace_app_sec_inc_1_1_file.html#a1b0de034680c8387ee2015f15fcb8fa6ae8bca6b3700b8453ef20b3cedbb10cef">AppSecInc::File::FILESIZE_AUTO</a> }, 
<a name="l00118"></a>00118     { L<span class="stringliteral">&quot;BYTES&quot;</span>, (WORD) <a class="code" href="namespace_app_sec_inc_1_1_file.html#a1b0de034680c8387ee2015f15fcb8fa6aeb34e81de3aeeaccc68a84f1998c0dfa" title="automatically adjust">AppSecInc::File::FILESIZE_BYTES</a> }, 
<a name="l00119"></a>00119     { L<span class="stringliteral">&quot;KB&quot;</span>, (WORD) <a class="code" href="namespace_app_sec_inc_1_1_file.html#a1b0de034680c8387ee2015f15fcb8fa6aa2d4b9cce9857fcce451ec6700594d99" title="byte(s)">AppSecInc::File::FILESIZE_KBYTES</a> }, 
<a name="l00120"></a>00120     { L<span class="stringliteral">&quot;MB&quot;</span>, (WORD) <a class="code" href="namespace_app_sec_inc_1_1_file.html#a1b0de034680c8387ee2015f15fcb8fa6ab9df0b438add0f0811fd7ef32866c017" title="Kb.">AppSecInc::File::FILESIZE_MBYTES</a> }, 
<a name="l00121"></a>00121     { L<span class="stringliteral">&quot;GB&quot;</span>, (WORD) <a class="code" href="namespace_app_sec_inc_1_1_file.html#a1b0de034680c8387ee2015f15fcb8fa6aaad9cd616d0e88f238baa74ae3cb0b2b" title="Mb.">AppSecInc::File::FILESIZE_GBYTES</a> }, 
<a name="l00122"></a>00122 };
<a name="l00123"></a>00123 
<a name="l00148"></a>00148 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a3d39699b73da42b71278aa0744a2597e" title="Get the size of a file.">Win32_GetFileSize</a>(MSIHANDLE hInstall);
<a name="l00149"></a>00149 
<a name="l00167"></a>00167 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a5853230d600dea21d00e5e8a077ee0e2" title="Check if file exists.">Win32_FileExists</a>(MSIHANDLE hInstall);
<a name="l00168"></a>00168 
<a name="l00179"></a>00179 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a31b1ef5f3440f5ebf29f115c2b4726c0" title="Get the parent directory.">Win32_GetParentDirectory</a>(MSIHANDLE hInstall);
<a name="l00180"></a>00180 
<a name="l00188"></a>00188 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a8f837476ee14c8ac1e600e1aacdc0d36" title="Read contents of an ANSI file into a property.">Win32_ReadFile</a>(MSIHANDLE hInstall);
<a name="l00189"></a>00189 
<a name="l00196"></a>00196 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a427b16cc4d6285c4eac3227ac5723050" title="Write to an ANSI text file.">Win32_WriteFile</a>(MSIHANDLE hInstall);
<a name="l00197"></a>00197 
<a name="l00204"></a>00204 <a class="code" href="_ca_decl_specs_8h.html#aff4b526ced58189f5c2252e52bdd57c6">CA_API</a> UINT __stdcall <a class="code" href="_win32_impl_8cpp.html#a4edaf5cf07492d440ddeaa7e8a75d255" title="Retrieves the path of a special folder, identified by its CSIDL.">Win32_GetSpecialFolderPath</a>(MSIHANDLE hInstall);
</pre></div></div>
</div>
  <br><hr noshade>
  <table width="100%">
   <tr>
    <td valign="top" align="left">
     <font size="1">&copy; Application Security Inc. - All Rights Reserved</font>
    </td>
    <td valign="top" align="right">
     <a href="http://msiext.codeplex.com" target="_blank">http://msiext.codeplex.com</a>
    </td>
   </tr>
  </table>
 </body>
 <head>
  <link href="tabs.css" rel="stylesheet" type="text/css">
 </head>
</html>
