<html>
 <head>
  <link rel="stylesheet" href="maven-theme.css"> 
  <title>AppSecInc. MSI Extensions</title>
 </head>
 <body>


<!-- Generated by Doxygen 1.7.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>src/Common/Service/ServiceInstance.h</h1>  </div>
</div>
<div class="contents">
<a href="_service_instance_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#pragma once</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span>
<a name="l00003"></a><a class="code" href="_service_instance_8h.html#a72f2da7225e346b5220f715dd21853a2">00003</a> <span class="preprocessor">#define SERVICE_CONTROL_START 0</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span>
<a name="l00005"></a>00005 <span class="keyword">namespace </span>AppSecInc 
<a name="l00006"></a>00006 {
<a name="l00007"></a>00007     <span class="keyword">namespace </span>Service 
<a name="l00008"></a>00008     {
<a name="l00010"></a><a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html">00010</a>         <span class="keyword">class </span><a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html" title="a service instance">ServiceInstance</a>
<a name="l00011"></a>00011         {
<a name="l00012"></a>00012         <span class="keyword">private</span>:
<a name="l00013"></a>00013             SC_HANDLE m_h;
<a name="l00014"></a>00014         <span class="keyword">public</span>:
<a name="l00015"></a>00015             <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a109eec083b842fc0f2c3ed911dec2d9f">ServiceInstance</a>();
<a name="l00016"></a>00016             <span class="keyword">virtual</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#abdc4aa579f3a7a2bd5b1bc290cfd66ec">~ServiceInstance</a>();
<a name="l00018"></a>00018             <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#ac9a9243a92cf29b68131ba527a869a7b" title="open the service instance object">Open</a>(<span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_manager.html" title="Service manager.">ServiceManager</a>&amp; scm, <span class="keyword">const</span> std::wstring&amp; name, DWORD access = SERVICE_ALL_ACCESS);
<a name="l00020"></a>00020                         <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a406a6c676ec0aed3b21491b3f47c1358" title="create a new service">Create</a>(<span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_manager.html" title="Service manager.">ServiceManager</a>&amp; scm, <span class="keyword">const</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_create_info.html" title="service creation information">ServiceCreateInfo</a>&amp; info);
<a name="l00022"></a>00022                         <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a801436e42813708f7c64b0be639c88ed" title="delete the service">Delete</a>();
<a name="l00024"></a>00024             <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a1ba36bdf0647fcbca2874e271ec2605c" title="close a previously opened service object">Close</a>();
<a name="l00026"></a><a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#ac52ea3068e17e6a09d7e87c58c0fcb9a">00026</a>             <span class="keywordtype">bool</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#ac52ea3068e17e6a09d7e87c58c0fcb9a" title="returns true if service is already open">IsOpen</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_h != NULL; }
<a name="l00028"></a><a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a0b39d79edee7df238e73adfc41e7f830">00028</a>             SC_HANDLE <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a0b39d79edee7df238e73adfc41e7f830" title="return the service handle">GetHandle</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_h; }
<a name="l00030"></a>00030             <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a0d1084d9ec71999d613137399f6522f0" title="return process information">GetServiceProcessStatus</a>(LPSERVICE_STATUS_PROCESS) <span class="keyword">const</span>;
<a name="l00032"></a>00032             <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a1788e38df56fab84c2ddae4d673c1554" title="control a service">Control</a>(DWORD control);
<a name="l00034"></a>00034             <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a989fb0abdf26b5d1d1d06cc4e9fa8b01" title="stop a service">Stop</a>();
<a name="l00036"></a>00036             <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a9bfefb66cefac2e36a49934136d5c594" title="start a service">Start</a>();
<a name="l00038"></a>00038             <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a5e6ec783eef1ce826cc219c0240eaa5d" title="restart a service">Restart</a>();
<a name="l00040"></a>00040             <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a8c3891abc7b2e40d2e99a7cce46ea826" title="pause a service">Pause</a>();
<a name="l00042"></a>00042             <span class="keywordtype">void</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a8127738202c785bdf9af617877952801" title="continue (resume) a service">Continue</a>();
<a name="l00044"></a>00044             DWORD <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#ad9e1f98e858cb0769bb3b4e8797c056d" title="return the service state">GetServiceState</a>() <span class="keyword">const</span>;
<a name="l00046"></a><a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a82eceef5e5883bdfea072d957921b8a0">00046</a>             <span class="keywordtype">bool</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a82eceef5e5883bdfea072d957921b8a0" title="returns true if the service is started">IsStarted</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (<a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#ad9e1f98e858cb0769bb3b4e8797c056d" title="return the service state">GetServiceState</a>() == SERVICE_RUNNING); }
<a name="l00048"></a><a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#aea59d037a96e0261957088d34bcffbfd">00048</a>             <span class="keywordtype">bool</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#aea59d037a96e0261957088d34bcffbfd" title="returns true if the service is stopped">IsStopped</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (<a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#ad9e1f98e858cb0769bb3b4e8797c056d" title="return the service state">GetServiceState</a>() == SERVICE_STOPPED); }
<a name="l00050"></a><a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a8011a4bc1e20e9abe4d9df9f04eda245">00050</a>             <span class="keywordtype">bool</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a8011a4bc1e20e9abe4d9df9f04eda245" title="returns true if the service is paused">IsPaused</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (<a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#ad9e1f98e858cb0769bb3b4e8797c056d" title="return the service state">GetServiceState</a>() == SERVICE_PAUSED); }
<a name="l00052"></a>00052             <span class="comment">// \param sleep number of milliseconds to sleep between checks</span>
<a name="l00053"></a>00053             <span class="comment">// \param timeout timeout to wait</span>
<a name="l00054"></a>00054             <span class="comment">// \return true if operation successful, false on timeout</span>
<a name="l00055"></a>00055             <span class="keywordtype">bool</span> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a6199a9f52f6433a5a09b390509a6e6a3" title="wait for a transition to complete while the service is pausing, starting, stopping, etc.">Wait</a>(DWORD timeout = INFINITE) <span class="keyword">const</span>;
<a name="l00057"></a>00057                         <a class="code" href="struct_app_sec_inc_1_1_service_1_1_service_config.html" title="service configuration">ServiceConfig</a> <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#ae8a08c1b504dcbcb38472422db69e07b" title="get service configuration">GetConfig</a>() <span class="keyword">const</span>;
<a name="l00059"></a>00059                         std::wstring <a class="code" href="class_app_sec_inc_1_1_service_1_1_service_instance.html#a47b91aabacef93280e07e93762c38296" title="get service description">GetDescription</a>() <span class="keyword">const</span>;
<a name="l00060"></a>00060         };
<a name="l00061"></a>00061     }
<a name="l00062"></a>00062 }
<a name="l00063"></a>00063 
</pre></div></div>
</div>
  <br><hr noshade>
  <table width="100%">
   <tr>
    <td valign="top" align="left">
     <font size="1">&copy; Application Security Inc. - All Rights Reserved</font>
    </td>
    <td valign="top" align="right">
     <a href="http://msiext.codeplex.com" target="_blank">http://msiext.codeplex.com</a>
    </td>
   </tr>
  </table>
 </body>
 <head>
  <link href="tabs.css" rel="stylesheet" type="text/css">
 </head>
</html>
