<html>
 <head>
  <link rel="stylesheet" href="maven-theme.css"> 
  <title>AppSecInc. MSI Extensions</title>
 </head>
 <body>


<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>src/CustomActions/SystemTools/CompareVersionImpl.cpp File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &quot;<a class="el" href="_tools_2_o_d_b_q_2_std_afx_8h_source.html">StdAfx.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="_compare_version_impl_8h_source.html">CompareVersionImpl.h</a>&quot;</code><br/>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_compare_version_impl_8cpp.html#a67ba74418295711458a5bb496cdbe5ec">CompareVersions</a> (MSIHANDLE hInstall)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compares dotted version strings.  <a href="#a67ba74418295711458a5bb496cdbe5ec"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CA_API UINT __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_compare_version_impl_8cpp.html#a4abf1c3373921cf0eac8c22cba402e11">CompareVersion</a> (MSIHANDLE hInstall)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compares dotted version strings.  <a href="#a4abf1c3373921cf0eac8c22cba402e11"></a><br/></td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a4abf1c3373921cf0eac8c22cba402e11"></a><!-- doxytag: member="CompareVersionImpl.cpp::CompareVersion" ref="a4abf1c3373921cf0eac8c22cba402e11" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall CompareVersion </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compares dotted version strings. </p>
<p>Compares the version string specfied by VERSION_INSTALLED to the version specified by VERSION_MINIMUM and optionally, VERSION_MAXIMUM. If VERSION_INSTALLED lies between these two versions, then the property specified by VERSION_PROPERTY is set.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>VERSION_INSTALLED</em>&nbsp;</td><td>version to compare </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>VERSION_MINIMUM</em>&nbsp;</td><td>mimumum allowed version </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>VERSION_MAXIMUM</em>&nbsp;</td><td>optional paramater specifying the maximum version allowed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>VERSION_PROPERTY</em>&nbsp;</td><td>property to set if the version check passes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a67ba74418295711458a5bb496cdbe5ec"></a><!-- doxytag: member="CompareVersionImpl.cpp::CompareVersions" ref="a67ba74418295711458a5bb496cdbe5ec" args="(MSIHANDLE hInstall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CA_API UINT __stdcall CompareVersions </td>
          <td>(</td>
          <td class="paramtype">MSIHANDLE&nbsp;</td>
          <td class="paramname"> <em>hInstall</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compares dotted version strings. </p>
<p>Compares the version string specfied by InstalledVersion to the version specified by MinimumVersion and optionally, MaximumVersion. If InstalledVersion lies between these two versions, then the property specified by the Property is set.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstalledVersion</em>&nbsp;</td><td>version to compare </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MinimumVersion</em>&nbsp;</td><td>mimumum allowed version </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MaximumVersion</em>&nbsp;</td><td>optional paramater specifying the maximum version allowed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Property</em>&nbsp;</td><td>property to set if the version check passes</td></tr>
  </table>
  </dd>
</dl>
<p>This is a table-driven custom action. It requires the following artifacts:</p>
<ol>
<li>
A custom table called CompareVersions. <div class="fragment"><pre class="fragment">    &lt;CustomTable Id=<span class="stringliteral">&quot;CompareVersions&quot;</span>&gt;
     &lt;Column Id=<span class="stringliteral">&quot;Id&quot;</span> PrimaryKey=<span class="stringliteral">&quot;yes&quot;</span> Type=<span class="stringliteral">&quot;string&quot;</span> /&gt;
     &lt;Column Id=<span class="stringliteral">&quot;InstalledVersion&quot;</span> Type=<span class="stringliteral">&quot;string&quot;</span> /&gt;
     &lt;Column Id=<span class="stringliteral">&quot;MinimumVersion&quot;</span> Type=<span class="stringliteral">&quot;string&quot;</span> /&gt;
     &lt;Column Id=<span class="stringliteral">&quot;MaximumVersion&quot;</span> Type=<span class="stringliteral">&quot;string&quot;</span> /&gt;
     &lt;Column Id=<span class="stringliteral">&quot;Property&quot;</span> Type=<span class="stringliteral">&quot;string&quot;</span> /&gt;
    &lt;/CustomTable&gt;
</pre></div> </li>
<li>
An immediate CompareVersions custom action. <div class="fragment"><pre class="fragment">     &lt;CustomAction Id=<span class="stringliteral">&quot;CompareVersions&quot;</span> BinaryKey=<span class="stringliteral">&quot;SystemTools&quot;</span> DllEntry=<span class="stringliteral">&quot;CompareVersions&quot;</span> Execute=<span class="stringliteral">&quot;immediate&quot;</span> Return=<span class="stringliteral">&quot;check&quot;</span> /&gt;
</pre></div> </li>
<li>
An execution sequence that schedules the above custom actions before LaunchConditions. <div class="fragment"><pre class="fragment">    &lt;InstallExecuteSequence&gt;
     &lt;Custom Action=<span class="stringliteral">&quot;CompareVersions&quot;</span> Before=<span class="stringliteral">&quot;LaunchConditions&quot;</span> Overridable=<span class="stringliteral">&quot;yes&quot;</span> /&gt;
    &lt;/InstallExecuteSequence&gt;
    &lt;InstallUISequence&gt;
     &lt;Custom Action=<span class="stringliteral">&quot;CompareVersions&quot;</span> Before=<span class="stringliteral">&quot;LaunchConditions&quot;</span> Overridable=<span class="stringliteral">&quot;yes&quot;</span> /&gt;
    &lt;/InstallUISequence&gt;
</pre></div> </li>
</ol>

</div>
</div>
</div>
  <br><hr noshade>
  <table width="100%">
   <tr>
    <td valign="top" align="left">
     <font size="1">&copy; Application Security Inc. - All Rights Reserved</font>
    </td>
    <td valign="top" align="right">
     <a href="http://msiext.codeplex.com" target="_blank">http://msiext.codeplex.com</a>
    </td>
   </tr>
  </table>
 </body>
 <head>
  <link href="tabs.css" rel="stylesheet" type="text/css">
 </head>
</html>
